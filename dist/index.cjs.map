{"version":3,"sources":["../src/types.ts","../src/adapters/cdp-adapter.ts","../src/adapters/python-bridge.ts","../src/adapters/nutjs-adapter.ts","../src/vlm/cost-tracker.ts","../src/vlm/cursor-bridge.ts","../src/vlm/client.ts","../src/core/desktop-test.ts","../src/core/assertions.ts","../src/core/test-runner.ts","../src/index.ts"],"names":["TestMode","LocatorStrategy","ActionStatus","VLMProvider","Platform","CDPAdapter","execSync","fs","PythonBridge","path","spawn","readline","resolve","NutJSAdapter","CostTracker","path2","fs2","VLMClient","DEFAULT_CONFIG"],"mappings":"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","file":"index.cjs","sourcesContent":["/**\n * @flowsight/desktop-test - Core Type Definitions\n *\n * Comprehensive type system for the hybrid desktop testing framework.\n * Combines deterministic DOM testing with VLM-powered visual AI fallback.\n */\n\n// ============================================================================\n// Enums\n// ============================================================================\n\n/**\n * Testing mode - determines element location strategy\n */\nexport enum TestMode {\n  /** DOM/Accessibility tree only - free, fast, deterministic */\n  DETERMINISTIC = 'deterministic',\n  /** VLM-based visual understanding - intelligent but costs API calls */\n  VISUAL = 'visual',\n  /** Smart: deterministic first, VLM fallback when element not found */\n  HYBRID = 'hybrid',\n}\n\n/**\n * Element location strategy\n */\nexport enum LocatorStrategy {\n  /** Reference from snapshot (e.g., @e1) */\n  REF = 'ref',\n  /** CSS selector */\n  CSS = 'css',\n  /** XPath */\n  XPATH = 'xpath',\n  /** ARIA role + name */\n  ROLE = 'role',\n  /** Text content */\n  TEXT = 'text',\n  /** Visual AI (screenshot + VLM) */\n  VISUAL = 'visual',\n  /** Test ID attribute */\n  TESTID = 'testid',\n}\n\n/**\n * Action execution status\n */\nexport enum ActionStatus {\n  SUCCESS = 'success',\n  FAILED = 'failed',\n  TIMEOUT = 'timeout',\n  NOT_FOUND = 'not_found',\n  VLM_FALLBACK = 'vlm_fallback',\n}\n\n/**\n * VLM Provider\n */\nexport enum VLMProvider {\n  ANTHROPIC = 'anthropic',\n  OPENAI = 'openai',\n  VOLCENGINE = 'volcengine',\n  DOUBAO = 'doubao',\n  CUSTOM = 'custom',\n  /** Use Cursor's built-in Claude model via MCP */\n  CURSOR = 'cursor',\n  /** \n   * Auto-detect any Claude Agent environment:\n   * - Cursor IDE\n   * - Claude Code CLI (terminal)\n   * - VSCode Claude plugin  \n   * - Claude Desktop\n   * - Any MCP environment\n   */\n  AGENT = 'agent',\n}\n\n/**\n * Platform type\n */\nexport enum Platform {\n  MACOS = 'darwin',\n  WINDOWS = 'win32',\n  LINUX = 'linux',\n}\n\n// ============================================================================\n// Configuration Types\n// ============================================================================\n\n/**\n * VLM configuration\n */\nexport interface VLMConfig {\n  /** Provider name */\n  provider: VLMProvider | string;\n  /** Model name */\n  model?: string;\n  /** API key (can also use env var) */\n  apiKey?: string;\n  /** API base URL (for custom providers) */\n  baseURL?: string;\n  /** Max tokens for response */\n  maxTokens?: number;\n  /** Temperature (0-1) */\n  temperature?: number;\n  /** Enable cost tracking */\n  trackCost?: boolean;\n}\n\n/**\n * CDP (Chrome DevTools Protocol) configuration\n */\nexport interface CDPConfig {\n  /** Port number or WebSocket URL */\n  endpoint: string | number;\n  /** Timeout for connection (ms) */\n  timeout?: number;\n}\n\n/**\n * Python bridge configuration\n */\nexport interface PythonBridgeConfig {\n  /** Path to Python executable */\n  pythonPath?: string;\n  /** Path to bridge server script */\n  serverPath?: string;\n  /** Communication port */\n  port?: number;\n  /** Enable debug logging */\n  debug?: boolean;\n}\n\n/**\n * NutJS (native desktop control) configuration\n */\nexport interface NutJSConfig {\n  /** Enable keyboard control */\n  keyboard?: boolean;\n  /** Enable mouse control */\n  mouse?: boolean;\n  /** Key press delay (ms) */\n  keyDelay?: number;\n  /** Mouse move speed */\n  mouseSpeed?: number;\n}\n\n/**\n * Main test configuration\n */\nexport interface DesktopTestConfig {\n  /** Testing mode */\n  mode?: TestMode | 'deterministic' | 'visual' | 'hybrid';\n  /** CDP configuration (for WebView testing) */\n  cdp?: CDPConfig;\n  /** VLM configuration (for visual AI mode) */\n  vlm?: VLMConfig;\n  /** Python bridge configuration (for native desktop control) */\n  pythonBridge?: PythonBridgeConfig;\n  /** NutJS configuration (for cross-platform native control) */\n  nutjs?: NutJSConfig;\n  /** Default timeout (ms) */\n  timeout?: number;\n  /** Enable debug logging */\n  debug?: boolean;\n  /** Screenshot directory */\n  screenshotDir?: string;\n  /** Video recording directory */\n  videoDir?: string;\n  /** Session name (for parallel testing) */\n  session?: string;\n}\n\n// ============================================================================\n// Element Types\n// ============================================================================\n\n/**\n * Bounding box for element positioning\n */\nexport interface BoundingBox {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n}\n\n/**\n * Element reference from snapshot\n */\nexport interface ElementRef {\n  /** Reference ID (e.g., \"e1\") */\n  id: string;\n  /** ARIA role */\n  role: string;\n  /** Accessible name */\n  name?: string;\n  /** Nth index (for disambiguation) */\n  nth?: number;\n  /** Bounding box (if available) */\n  boundingBox?: BoundingBox;\n  /** Source: how this element was found */\n  source?: 'dom' | 'accessibility' | 'vlm';\n}\n\n/**\n * Snapshot result from page\n */\nexport interface SnapshotResult {\n  /** Accessibility tree as string */\n  tree: string;\n  /** Element references map */\n  refs: Record<string, ElementRef>;\n  /** Timestamp */\n  timestamp: number;\n  /** Screenshot base64 (if captured) */\n  screenshot?: string;\n}\n\n/**\n * Element locator specification\n */\nexport interface ElementLocator {\n  /** Locator strategy */\n  strategy: LocatorStrategy;\n  /** Locator value */\n  value: string;\n  /** Optional: within another element */\n  within?: ElementLocator;\n  /** Optional: nth match */\n  nth?: number;\n}\n\n// ============================================================================\n// Action Types\n// ============================================================================\n\n/**\n * Click options\n */\nexport interface ClickOptions {\n  /** Button: left, right, middle */\n  button?: 'left' | 'right' | 'middle';\n  /** Click count */\n  count?: number;\n  /** Delay between clicks (ms) */\n  delay?: number;\n  /** Force click even if not visible */\n  force?: boolean;\n  /** Timeout (ms) */\n  timeout?: number;\n}\n\n/**\n * Type/input options\n */\nexport interface TypeOptions {\n  /** Delay between keystrokes (ms) */\n  delay?: number;\n  /** Clear existing content first */\n  clear?: boolean;\n  /** Press Enter after typing */\n  submit?: boolean;\n}\n\n/**\n * Scroll options\n */\nexport interface ScrollOptions {\n  /** Direction */\n  direction: 'up' | 'down' | 'left' | 'right';\n  /** Amount in pixels */\n  amount?: number;\n  /** Smooth scroll */\n  smooth?: boolean;\n}\n\n/**\n * Wait options\n */\nexport interface WaitOptions {\n  /** Timeout (ms) */\n  timeout?: number;\n  /** Polling interval (ms) */\n  interval?: number;\n  /** State to wait for */\n  state?: 'visible' | 'hidden' | 'attached' | 'detached';\n}\n\n/**\n * Screenshot options\n */\nexport interface ScreenshotOptions {\n  /** Full page screenshot */\n  fullPage?: boolean;\n  /** Format */\n  format?: 'png' | 'jpeg';\n  /** Quality (jpeg only) */\n  quality?: number;\n  /** Clip region */\n  clip?: BoundingBox;\n}\n\n/**\n * Action result with detailed information\n */\nexport interface ActionResult<T = void> {\n  /** Status */\n  status: ActionStatus;\n  /** Result data */\n  data?: T;\n  /** Error message */\n  error?: string;\n  /** Execution time (ms) */\n  duration: number;\n  /** Used VLM fallback */\n  usedVLM: boolean;\n  /** VLM cost (if tracked) */\n  vlmCost?: number;\n  /** Screenshot (if captured) */\n  screenshot?: string;\n}\n\n// ============================================================================\n// VLM Types\n// ============================================================================\n\n/**\n * VLM request for element finding\n */\nexport interface VLMFindRequest {\n  /** Screenshot base64 */\n  screenshot: string;\n  /** Element description */\n  description: string;\n  /** Context (what we're looking for) */\n  context?: string;\n  /** Previous actions (for context) */\n  history?: string[];\n}\n\n/**\n * VLM response for element finding\n */\nexport interface VLMFindResponse {\n  /** Found element coordinates */\n  coordinates?: { x: number; y: number };\n  /** Confidence (0-1) */\n  confidence: number;\n  /** Reasoning */\n  reasoning: string;\n  /** Element not found */\n  notFound?: boolean;\n  /** Suggested alternative */\n  alternative?: string;\n}\n\n/**\n * VLM request for action execution\n */\nexport interface VLMActionRequest {\n  /** Screenshot base64 */\n  screenshot: string;\n  /** Instruction */\n  instruction: string;\n  /** Available action spaces */\n  actionSpaces: string[];\n}\n\n/**\n * VLM response for action execution\n */\nexport interface VLMActionResponse {\n  /** Action type */\n  actionType: string;\n  /** Action parameters */\n  actionParams: Record<string, unknown>;\n  /** Thought process */\n  thought: string;\n  /** Reflection */\n  reflection?: string;\n  /** Is task finished */\n  finished: boolean;\n}\n\n/**\n * VLM request for assertion\n */\nexport interface VLMAssertRequest {\n  /** Screenshot base64 */\n  screenshot: string;\n  /** Assertion description */\n  assertion: string;\n  /** Expected behavior */\n  expected?: string;\n}\n\n/**\n * VLM response for assertion\n */\nexport interface VLMAssertResponse {\n  /** Assertion passed */\n  passed: boolean;\n  /** Reasoning */\n  reasoning: string;\n  /** Actual observation */\n  actual: string;\n  /** Suggestions for fixing */\n  suggestions?: string[];\n}\n\n/**\n * Cost tracking entry\n */\nexport interface CostEntry {\n  /** Provider */\n  provider: VLMProvider | string;\n  /** Model */\n  model: string;\n  /** Input tokens */\n  inputTokens: number;\n  /** Output tokens */\n  outputTokens: number;\n  /** Images count */\n  images: number;\n  /** Estimated cost (USD) */\n  cost: number;\n  /** Timestamp */\n  timestamp: number;\n  /** Operation type */\n  operation: 'find' | 'action' | 'assert' | 'analyze';\n}\n\n/**\n * Cost summary\n */\nexport interface CostSummary {\n  /** Total cost (USD) */\n  totalCost: number;\n  /** Total API calls */\n  totalCalls: number;\n  /** Cost by provider */\n  byProvider: Record<string, number>;\n  /** Cost by operation */\n  byOperation: Record<string, number>;\n  /** Detailed entries */\n  entries: CostEntry[];\n}\n\n// ============================================================================\n// Test Types\n// ============================================================================\n\n/**\n * Test case definition\n */\nexport interface TestCase {\n  /** Test name */\n  name: string;\n  /** Test category */\n  category?: string;\n  /** Test function */\n  fn: TestFunction;\n  /** Test timeout */\n  timeout?: number;\n  /** Skip test */\n  skip?: boolean;\n  /** Only run this test */\n  only?: boolean;\n  /** Retry count */\n  retries?: number;\n}\n\n/**\n * Test function signature\n */\nexport type TestFunction = (ctx: TestContext) => Promise<void>;\n\n/**\n * Test context (passed to test functions)\n */\nexport interface TestContext {\n  /** Desktop test instance */\n  test: DesktopTestInstance;\n  /** Assertions */\n  assert: AssertionMethods;\n  /** Logger */\n  log: LogMethods;\n}\n\n/**\n * Desktop test instance interface (main API)\n */\nexport interface DesktopTestInstance {\n  // Connection\n  connect(): Promise<void>;\n  disconnect(): Promise<void>;\n  isConnected(): boolean;\n\n  // Snapshot\n  snapshot(options?: { interactive?: boolean }): Promise<SnapshotResult>;\n\n  // Element finding\n  find(locator: string | ElementLocator): Promise<ElementRef | null>;\n  findAll(locator: string | ElementLocator): Promise<ElementRef[]>;\n  waitFor(locator: string | ElementLocator, options?: WaitOptions): Promise<ElementRef>;\n\n  // Actions\n  click(locator: string | ElementLocator, options?: ClickOptions): Promise<ActionResult>;\n  dblclick(locator: string | ElementLocator): Promise<ActionResult>;\n  rightClick(locator: string | ElementLocator): Promise<ActionResult>;\n  type(locator: string | ElementLocator, text: string, options?: TypeOptions): Promise<ActionResult>;\n  fill(locator: string | ElementLocator, text: string): Promise<ActionResult>;\n  clear(locator: string | ElementLocator): Promise<ActionResult>;\n  press(key: string): Promise<ActionResult>;\n  hover(locator: string | ElementLocator): Promise<ActionResult>;\n  scroll(options: ScrollOptions): Promise<ActionResult>;\n  drag(from: string | ElementLocator, to: string | ElementLocator): Promise<ActionResult>;\n\n  // Visual AI methods (VLM mode)\n  clickText(text: string): Promise<ActionResult>;\n  clickImage(description: string): Promise<ActionResult>;\n  ai(instruction: string): Promise<ActionResult>;\n\n  // Getters\n  getText(locator: string | ElementLocator): Promise<string>;\n  getValue(locator: string | ElementLocator): Promise<string>;\n  getAttribute(locator: string | ElementLocator, attr: string): Promise<string | null>;\n  isVisible(locator: string | ElementLocator): Promise<boolean>;\n  isEnabled(locator: string | ElementLocator): Promise<boolean>;\n  count(locator: string | ElementLocator): Promise<number>;\n  boundingBox(locator: string | ElementLocator): Promise<BoundingBox | null>;\n\n  // Page\n  getUrl(): Promise<string>;\n  getTitle(): Promise<string>;\n  evaluate<T>(script: string): Promise<T>;\n\n  // Screenshot & Recording\n  screenshot(path?: string, options?: ScreenshotOptions): Promise<string>;\n  startRecording(path: string): Promise<void>;\n  stopRecording(): Promise<{ path: string }>;\n\n  // Cost tracking\n  getCostSummary(): CostSummary;\n  resetCostTracking(): void;\n\n  // Utilities\n  wait(ms: number): Promise<void>;\n  waitForIdle(timeout?: number): Promise<void>;\n}\n\n/**\n * Assertion methods\n */\nexport interface AssertionMethods {\n  // Basic\n  ok(condition: boolean, message?: string): void;\n  equal<T>(actual: T, expected: T, message?: string): void;\n  notEqual<T>(actual: T, expected: T, message?: string): void;\n\n  // Numbers\n  greaterThan(actual: number, expected: number, message?: string): void;\n  lessThan(actual: number, expected: number, message?: string): void;\n  greaterOrEqual(actual: number, expected: number, message?: string): void;\n  lessOrEqual(actual: number, expected: number, message?: string): void;\n\n  // Strings\n  contains(haystack: string, needle: string, message?: string): void;\n  matches(actual: string, pattern: RegExp, message?: string): void;\n\n  // Elements\n  exists(locator: string | ElementLocator, message?: string): Promise<void>;\n  notExists(locator: string | ElementLocator, message?: string): Promise<void>;\n  visible(locator: string | ElementLocator, message?: string): Promise<void>;\n  hidden(locator: string | ElementLocator, message?: string): Promise<void>;\n  hasText(locator: string | ElementLocator, text: string, message?: string): Promise<void>;\n  hasValue(locator: string | ElementLocator, value: string, message?: string): Promise<void>;\n  hasAttribute(locator: string | ElementLocator, attr: string, value?: string, message?: string): Promise<void>;\n\n  // Data correctness (key feature for preventing \"0 files\" bug)\n  notZero(locator: string | ElementLocator, message?: string): Promise<void>;\n  notEmpty(locator: string | ElementLocator, message?: string): Promise<void>;\n  dataCorrect(locator: string | ElementLocator, validator: (data: string) => boolean, message?: string): Promise<void>;\n\n  // Visual AI assertions\n  visualCheck(description: string, message?: string): Promise<void>;\n  noVisualRegression(baseline: string, threshold?: number): Promise<void>;\n}\n\n/**\n * Log methods\n */\nexport interface LogMethods {\n  info(message: string, ...args: unknown[]): void;\n  warn(message: string, ...args: unknown[]): void;\n  error(message: string, ...args: unknown[]): void;\n  debug(message: string, ...args: unknown[]): void;\n  step(message: string): void;\n}\n\n// ============================================================================\n// Test Runner Types\n// ============================================================================\n\n/**\n * Test result\n */\nexport interface TestResult {\n  /** Test case */\n  test: TestCase;\n  /** Passed */\n  passed: boolean;\n  /** Error */\n  error?: Error;\n  /** Duration (ms) */\n  duration: number;\n  /** Screenshots captured */\n  screenshots: string[];\n  /** Video path */\n  video?: string;\n  /** Used VLM */\n  usedVLM: boolean;\n  /** VLM cost */\n  vlmCost?: number;\n}\n\n/**\n * Test suite result\n */\nexport interface TestSuiteResult {\n  /** Suite name */\n  name: string;\n  /** Test results */\n  tests: TestResult[];\n  /** Total passed */\n  passed: number;\n  /** Total failed */\n  failed: number;\n  /** Total skipped */\n  skipped: number;\n  /** Total duration */\n  duration: number;\n  /** Total VLM cost */\n  totalVLMCost: number;\n}\n\n/**\n * Reporter interface\n */\nexport interface Reporter {\n  onTestStart(test: TestCase): void;\n  onTestEnd(result: TestResult): void;\n  onSuiteStart(name: string): void;\n  onSuiteEnd(result: TestSuiteResult): void;\n}\n\n// ============================================================================\n// Adapter Interfaces\n// ============================================================================\n\n/**\n * Base adapter interface\n */\nexport interface Adapter {\n  /** Initialize adapter */\n  initialize(): Promise<void>;\n  /** Cleanup adapter */\n  cleanup(): Promise<void>;\n  /** Check if available */\n  isAvailable(): boolean;\n}\n\n/**\n * CDP adapter interface\n */\nexport interface CDPAdapterInterface extends Adapter {\n  connect(): Promise<void>;\n  disconnect(): Promise<void>;\n  getSnapshot(options?: { interactive?: boolean; includeScreenshot?: boolean }): Promise<SnapshotResult>;\n  find(locator: ElementLocator): Promise<ElementRef | null>;\n  findAll(locator: ElementLocator): Promise<ElementRef[]>;\n  click(element: ElementRef, options?: ClickOptions): Promise<void>;\n  type(element: ElementRef, text: string, options?: TypeOptions): Promise<void>;\n  press(key: string): Promise<void>;\n  hover(element: ElementRef): Promise<void>;\n  scroll(options: ScrollOptions): Promise<void>;\n  drag(from: ElementRef, to: ElementRef): Promise<void>;\n  getText(element: ElementRef): Promise<string>;\n  getValue(element: ElementRef): Promise<string>;\n  getAttribute(element: ElementRef, attr: string): Promise<string | null>;\n  isVisible(element: ElementRef): Promise<boolean>;\n  isEnabled(element: ElementRef): Promise<boolean>;\n  getUrl(): Promise<string>;\n  getTitle(): Promise<string>;\n  evaluate<T>(script: string): Promise<T>;\n  screenshot(path?: string, options?: ScreenshotOptions): Promise<string>;\n  getScreenshotBase64(): Promise<string>;\n  startRecording(path: string): Promise<void>;\n  stopRecording(): Promise<{ path: string }>;\n  waitForIdle(timeout?: number): Promise<void>;\n}\n\n/**\n * Python bridge adapter interface\n */\nexport interface PythonBridgeInterface extends Adapter {\n  /** Call Python method */\n  call<T>(method: string, args?: unknown[]): Promise<T>;\n  /** Take screenshot via Python */\n  screenshot(): Promise<string>;\n  /** Click at coordinates via Python */\n  click(x: number, y: number, button?: string): Promise<void>;\n  /** Type text via Python */\n  typeText(text: string): Promise<void>;\n  /** Press key via Python */\n  pressKey(key: string, modifiers?: string[]): Promise<void>;\n  /** Get accessibility tree via Python */\n  getAccessibilityTree(): Promise<unknown>;\n  /** Analyze screenshot with VLM via Python */\n  analyzeVisual(screenshotBase64: string): Promise<unknown>;\n}\n\n/**\n * NutJS adapter interface\n */\nexport interface NutJSAdapterInterface extends Adapter {\n  click(x: number, y: number, button?: 'left' | 'right' | 'middle', count?: number): Promise<void>;\n  moveTo(x: number, y: number): Promise<void>;\n  type(text: string, delay?: number): Promise<void>;\n  press(key: string): Promise<void>;\n  scroll(direction: 'up' | 'down' | 'left' | 'right', amount: number): Promise<void>;\n  drag(fromX: number, fromY: number, toX: number, toY: number): Promise<void>;\n  screenshot(): Promise<string>;\n  getScreenSize(): Promise<{ width: number; height: number }>;\n}\n\n/**\n * VLM client interface\n */\nexport interface VLMClientInterface {\n  findElement(request: VLMFindRequest): Promise<VLMFindResponse>;\n  getNextAction(request: VLMActionRequest): Promise<VLMActionResponse>;\n  assertVisual(request: VLMAssertRequest): Promise<VLMAssertResponse>;\n  getCostSummary(): CostSummary;\n  resetCostTracking(): void;\n}\n","/**\n * @flowsight/desktop-test - CDP Adapter\n *\n * Chrome DevTools Protocol adapter for WebView/Browser control.\n * Uses agent-browser CLI under the hood for Tauri/Electron app testing.\n */\n\nimport { execSync } from 'child_process';\nimport * as fs from 'fs';\n\nimport {\n  LocatorStrategy,\n  type CDPConfig,\n  type SnapshotResult,\n  type ElementRef,\n  type ElementLocator,\n  type ClickOptions,\n  type TypeOptions,\n  type ScrollOptions,\n  type ScreenshotOptions,\n  type CDPAdapterInterface,\n} from '../types.js';\n\n/**\n * CDP Adapter - controls WebView through Chrome DevTools Protocol\n */\nexport class CDPAdapter implements CDPAdapterInterface {\n  private config: Required<CDPConfig>;\n  private connected: boolean = false;\n  private refMap: Map<string, ElementRef> = new Map();\n  private refCounter: number = 0;\n  private session: string;\n\n  constructor(config: CDPConfig) {\n    this.config = {\n      endpoint: config.endpoint,\n      timeout: config.timeout || 30000,\n    };\n    this.session = `session_${Date.now()}`;\n  }\n\n  /**\n   * Initialize adapter\n   */\n  async initialize(): Promise<void> {\n    // Check if agent-browser is available\n    try {\n      execSync('agent-browser --version', { encoding: 'utf-8', stdio: 'pipe' });\n    } catch {\n      console.warn('[CDP Adapter] agent-browser not found. Install with: npm install -g agent-browser');\n    }\n  }\n\n  /**\n   * Cleanup adapter\n   */\n  async cleanup(): Promise<void> {\n    await this.disconnect();\n  }\n\n  /**\n   * Check if available\n   */\n  isAvailable(): boolean {\n    try {\n      execSync('agent-browser --version', { encoding: 'utf-8', stdio: 'pipe' });\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * Connect to the browser/app via CDP\n   */\n  async connect(): Promise<void> {\n    const endpoint = typeof this.config.endpoint === 'number'\n      ? String(this.config.endpoint)\n      : this.config.endpoint;\n\n    try {\n      this.exec(['open', `--cdp=${endpoint}`]);\n      this.connected = true;\n    } catch (error: unknown) {\n      const message = error instanceof Error ? error.message : String(error);\n      throw new Error(`Failed to connect via CDP: ${message}`);\n    }\n  }\n\n  /**\n   * Disconnect from the browser/app\n   */\n  async disconnect(): Promise<void> {\n    if (!this.connected) return;\n\n    try {\n      this.exec(['close']);\n    } catch {\n      // Ignore close errors\n    }\n\n    this.connected = false;\n  }\n\n  /**\n   * Get accessibility snapshot with refs\n   */\n  async getSnapshot(options: { interactive?: boolean; includeScreenshot?: boolean } = {}): Promise<SnapshotResult> {\n    this.ensureConnected();\n\n    const args = ['snapshot'];\n    if (options.interactive) args.push('-i');\n\n    const result = this.execJson<{ snapshot: string; refs?: Record<string, { role: string; name?: string }> }>(args);\n\n    // Convert refs to our format\n    const refs: Record<string, ElementRef> = {};\n    if (result.refs) {\n      for (const [key, value] of Object.entries(result.refs)) {\n        refs[key] = {\n          id: key,\n          role: value.role,\n          name: value.name,\n          source: 'dom',\n        };\n        this.refMap.set(key, refs[key]);\n      }\n    }\n\n    let screenshot: string | undefined;\n    if (options.includeScreenshot) {\n      screenshot = await this.getScreenshotBase64();\n    }\n\n    return {\n      tree: result.snapshot || '',\n      refs,\n      timestamp: Date.now(),\n      screenshot,\n    };\n  }\n\n  /**\n   * Find single element\n   */\n  async find(locator: ElementLocator): Promise<ElementRef | null> {\n    this.ensureConnected();\n\n    try {\n      const selector = this.locatorToSelector(locator);\n      const result = this.execJson<{ visible: boolean }>(['is', 'visible', selector]);\n\n      if (result.visible) {\n        const refId = `cdp_${++this.refCounter}`;\n        return {\n          id: refId,\n          role: 'element',\n          name: locator.value,\n          source: 'dom',\n        };\n      }\n    } catch {\n      // Element not found\n    }\n\n    return null;\n  }\n\n  /**\n   * Find all matching elements\n   */\n  async findAll(locator: ElementLocator): Promise<ElementRef[]> {\n    this.ensureConnected();\n\n    try {\n      const selector = this.locatorToSelector(locator);\n      const result = this.execJson<{ count: number }>(['get', 'count', selector]);\n\n      const count = result.count || 0;\n      return Array.from({ length: count }, (_, i) => ({\n        id: `cdp_${++this.refCounter}`,\n        role: 'element',\n        name: locator.value,\n        nth: i,\n        source: 'dom' as const,\n      }));\n    } catch {\n      return [];\n    }\n  }\n\n  /**\n   * Click element\n   */\n  async click(element: ElementRef, options: ClickOptions = {}): Promise<void> {\n    this.ensureConnected();\n\n    const selector = this.elementToSelector(element);\n    const args = ['click', selector];\n\n    if (options.count && options.count > 1) {\n      // For double-click\n      this.exec(['dblclick', selector]);\n    } else {\n      this.exec(args);\n    }\n  }\n\n  /**\n   * Type text\n   */\n  async type(element: ElementRef, text: string, _options: TypeOptions = {}): Promise<void> {\n    this.ensureConnected();\n\n    const selector = this.elementToSelector(element);\n    const escapedText = text.replace(/\"/g, '\\\\\"');\n    this.exec(['type', selector, `\"${escapedText}\"`]);\n  }\n\n  /**\n   * Press key\n   */\n  async press(key: string): Promise<void> {\n    this.ensureConnected();\n    this.exec(['press', key]);\n  }\n\n  /**\n   * Hover over element\n   */\n  async hover(element: ElementRef): Promise<void> {\n    this.ensureConnected();\n\n    const selector = this.elementToSelector(element);\n    this.exec(['hover', selector]);\n  }\n\n  /**\n   * Scroll\n   */\n  async scroll(options: ScrollOptions): Promise<void> {\n    this.ensureConnected();\n\n    const amount = options.amount || 100;\n    this.exec(['scroll', options.direction, String(amount)]);\n  }\n\n  /**\n   * Drag element\n   */\n  async drag(from: ElementRef, to: ElementRef): Promise<void> {\n    this.ensureConnected();\n\n    const fromSelector = this.elementToSelector(from);\n    const toSelector = this.elementToSelector(to);\n    this.exec(['drag', fromSelector, toSelector]);\n  }\n\n  /**\n   * Get element text\n   */\n  async getText(element: ElementRef): Promise<string> {\n    this.ensureConnected();\n\n    const selector = this.elementToSelector(element);\n    const result = this.execJson<{ text: string }>(['get', 'text', selector]);\n    return result.text || '';\n  }\n\n  /**\n   * Get element value\n   */\n  async getValue(element: ElementRef): Promise<string> {\n    this.ensureConnected();\n\n    const selector = this.elementToSelector(element);\n    const result = this.execJson<{ value: string }>(['get', 'value', selector]);\n    return result.value || '';\n  }\n\n  /**\n   * Get element attribute\n   */\n  async getAttribute(element: ElementRef, attr: string): Promise<string | null> {\n    this.ensureConnected();\n\n    const selector = this.elementToSelector(element);\n    const result = this.execJson<{ value: string | null }>(['get', 'attr', selector, attr]);\n    return result.value;\n  }\n\n  /**\n   * Check if element is visible\n   */\n  async isVisible(element: ElementRef): Promise<boolean> {\n    this.ensureConnected();\n\n    try {\n      const selector = this.elementToSelector(element);\n      const result = this.execJson<{ visible: boolean }>(['is', 'visible', selector]);\n      return result.visible;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * Check if element is enabled\n   */\n  async isEnabled(element: ElementRef): Promise<boolean> {\n    this.ensureConnected();\n\n    try {\n      const selector = this.elementToSelector(element);\n      const result = this.execJson<{ enabled: boolean }>(['is', 'enabled', selector]);\n      return result.enabled;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * Get current URL\n   */\n  async getUrl(): Promise<string> {\n    this.ensureConnected();\n\n    const result = this.execJson<{ url: string }>(['get', 'url']);\n    return result.url || '';\n  }\n\n  /**\n   * Get page title\n   */\n  async getTitle(): Promise<string> {\n    this.ensureConnected();\n\n    const result = this.execJson<{ title: string }>(['get', 'title']);\n    return result.title || '';\n  }\n\n  /**\n   * Evaluate JavaScript\n   */\n  async evaluate<T>(script: string): Promise<T> {\n    this.ensureConnected();\n\n    const escapedScript = script.replace(/\"/g, '\\\\\"');\n    const result = this.execJson<{ result: T }>(['eval', `\"${escapedScript}\"`]);\n    return result.result;\n  }\n\n  /**\n   * Take screenshot\n   */\n  async screenshot(screenshotPath?: string, options: ScreenshotOptions = {}): Promise<string> {\n    this.ensureConnected();\n\n    const args = ['screenshot'];\n    if (screenshotPath) args.push(screenshotPath);\n    if (options.fullPage) args.push('--full');\n\n    const result = this.execJson<{ path: string }>(args);\n    return result.path;\n  }\n\n  /**\n   * Get screenshot as base64\n   */\n  async getScreenshotBase64(): Promise<string> {\n    const tempPath = `/tmp/desktop-test-screenshot-${Date.now()}.jpg`;\n\n    try {\n      this.exec(['screenshot', tempPath]);\n      const data = fs.readFileSync(tempPath);\n      return data.toString('base64');\n    } finally {\n      if (fs.existsSync(tempPath)) {\n        fs.unlinkSync(tempPath);\n      }\n    }\n  }\n\n  /**\n   * Start recording\n   */\n  async startRecording(recordingPath: string): Promise<void> {\n    this.ensureConnected();\n    this.exec(['record', 'start', recordingPath]);\n  }\n\n  /**\n   * Stop recording\n   */\n  async stopRecording(): Promise<{ path: string }> {\n    this.ensureConnected();\n\n    const result = this.execJson<{ path: string }>(['record', 'stop']);\n    return { path: result.path || '' };\n  }\n\n  /**\n   * Wait for page to be idle\n   */\n  async waitForIdle(timeout: number = 5000): Promise<void> {\n    this.ensureConnected();\n    this.exec(['wait', '--load', 'networkidle'], { timeout });\n  }\n\n  // ============================================================================\n  // Private Helpers\n  // ============================================================================\n\n  private ensureConnected(): void {\n    if (!this.connected) {\n      throw new Error('CDP adapter not connected');\n    }\n  }\n\n  private exec(args: string[], options: { timeout?: number } = {}): string {\n    const sessionArg = `--session=${this.session}`;\n    const cmd = `agent-browser ${sessionArg} ${args.join(' ')}`.trim();\n\n    try {\n      return execSync(cmd, {\n        encoding: 'utf-8',\n        timeout: options.timeout ?? this.config.timeout,\n        stdio: ['pipe', 'pipe', 'pipe'],\n      }).trim();\n    } catch (err: unknown) {\n      const error = err as { stderr?: Buffer; stdout?: Buffer; message?: string };\n      const stderr = error.stderr?.toString() || '';\n      const stdout = error.stdout?.toString() || '';\n      throw new Error(`agent-browser command failed: ${cmd}\\nstderr: ${stderr}\\nstdout: ${stdout}`);\n    }\n  }\n\n  private execJson<T>(args: string[]): T {\n    const result = this.exec([...args, '--json']);\n\n    try {\n      const parsed = JSON.parse(result);\n      if (!parsed.success && parsed.error) {\n        throw new Error(parsed.error);\n      }\n      return (parsed.data || parsed) as T;\n    } catch (err: unknown) {\n      if (err instanceof Error && err.message.includes('agent-browser')) {\n        throw err;\n      }\n      throw new Error(`JSON parse failed: ${result}`);\n    }\n  }\n\n  private locatorToSelector(locator: ElementLocator): string {\n    switch (locator.strategy) {\n      case LocatorStrategy.REF:\n        return locator.value.startsWith('@') ? locator.value : `@${locator.value}`;\n      case LocatorStrategy.CSS:\n        return locator.value;\n      case LocatorStrategy.XPATH:\n        return `xpath=${locator.value}`;\n      case LocatorStrategy.TEXT:\n        return `text=${locator.value}`;\n      case LocatorStrategy.ROLE:\n        return `role=${locator.value}`;\n      case LocatorStrategy.TESTID:\n        return locator.value;\n      default:\n        return locator.value;\n    }\n  }\n\n  private elementToSelector(element: ElementRef): string {\n    if (element.id.startsWith('cdp_')) {\n      return element.name || '';\n    }\n    return `@${element.id}`;\n  }\n}\n","/**\n * @flowsight/desktop-test - Python Bridge Adapter\n *\n * Bridge to the existing Python desktop automation framework.\n * Communicates with Python via subprocess and JSON-RPC style messages.\n */\n\nimport { spawn, ChildProcess } from 'child_process';\nimport * as path from 'path';\nimport * as readline from 'readline';\n\nimport {\n  type PythonBridgeConfig,\n  type PythonBridgeInterface,\n} from '../types.js';\n\n/**\n * Default Python bridge configuration\n */\nconst DEFAULT_CONFIG: Required<PythonBridgeConfig> = {\n  pythonPath: 'python3',\n  serverPath: '',\n  port: 0,\n  debug: false,\n};\n\n/**\n * Python Bridge - connects to the existing Python desktop automation framework\n */\nexport class PythonBridge implements PythonBridgeInterface {\n  private config: Required<PythonBridgeConfig>;\n  private process: ChildProcess | null = null;\n  private available: boolean = false;\n  private requestId: number = 0;\n  private pendingRequests: Map<number, {\n    resolve: (value: unknown) => void;\n    reject: (error: Error) => void;\n  }> = new Map();\n  private readline: readline.Interface | null = null;\n\n  constructor(config: PythonBridgeConfig = {}) {\n    this.config = { ...DEFAULT_CONFIG, ...config };\n\n    // Default server path relative to this package\n    if (!this.config.serverPath) {\n      // Look for bridge server in the app/tests/desktop directory\n      this.config.serverPath = path.resolve(\n        __dirname,\n        '../../../../app/tests/desktop/bridge_server.py'\n      );\n    }\n  }\n\n  /**\n   * Initialize the Python bridge\n   */\n  async initialize(): Promise<void> {\n    try {\n      // Spawn Python subprocess\n      this.process = spawn(this.config.pythonPath, [this.config.serverPath], {\n        stdio: ['pipe', 'pipe', 'pipe'],\n        env: {\n          ...process.env,\n          PYTHONUNBUFFERED: '1',\n        },\n      });\n\n      if (!this.process.stdout || !this.process.stdin) {\n        throw new Error('Failed to create Python process streams');\n      }\n\n      // Set up readline for stdout\n      this.readline = readline.createInterface({\n        input: this.process.stdout,\n        terminal: false,\n      });\n\n      // Handle responses\n      this.readline.on('line', (line) => {\n        this.handleResponse(line);\n      });\n\n      // Handle stderr for debugging\n      this.process.stderr?.on('data', (data) => {\n        if (this.config.debug) {\n          console.error(`[Python Bridge stderr] ${data.toString()}`);\n        }\n      });\n\n      // Handle process exit\n      this.process.on('exit', (code) => {\n        this.available = false;\n        if (this.config.debug) {\n          console.log(`[Python Bridge] Process exited with code ${code}`);\n        }\n      });\n\n      // Wait for ready signal\n      await this.waitForReady();\n      this.available = true;\n\n      if (this.config.debug) {\n        console.log('[Python Bridge] Initialized successfully');\n      }\n    } catch (error) {\n      this.available = false;\n      throw error;\n    }\n  }\n\n  /**\n   * Cleanup the Python bridge\n   */\n  async cleanup(): Promise<void> {\n    if (this.process) {\n      try {\n        await this.call('shutdown');\n      } catch {\n        // Ignore shutdown errors\n      }\n\n      this.process.kill();\n      this.process = null;\n    }\n\n    if (this.readline) {\n      this.readline.close();\n      this.readline = null;\n    }\n\n    this.available = false;\n    this.pendingRequests.clear();\n  }\n\n  /**\n   * Check if available\n   */\n  isAvailable(): boolean {\n    return this.available && this.process !== null;\n  }\n\n  /**\n   * Call a Python method\n   */\n  async call<T>(method: string, args: unknown[] = []): Promise<T> {\n    if (!this.isAvailable()) {\n      throw new Error('Python bridge not available');\n    }\n\n    const id = ++this.requestId;\n    const request = {\n      jsonrpc: '2.0',\n      id,\n      method,\n      params: args,\n    };\n\n    return new Promise((resolve, reject) => {\n      this.pendingRequests.set(id, { resolve: resolve as (v: unknown) => void, reject });\n\n      // Send request\n      this.process!.stdin!.write(JSON.stringify(request) + '\\n');\n\n      // Timeout\n      setTimeout(() => {\n        if (this.pendingRequests.has(id)) {\n          this.pendingRequests.delete(id);\n          reject(new Error(`Python bridge timeout for method: ${method}`));\n        }\n      }, 30000);\n    });\n  }\n\n  /**\n   * Take screenshot via Python\n   */\n  async screenshot(): Promise<string> {\n    return this.call<string>('screenshot');\n  }\n\n  /**\n   * Click at coordinates via Python\n   */\n  async click(x: number, y: number, button: string = 'left'): Promise<void> {\n    await this.call('click', [x, y, button]);\n  }\n\n  /**\n   * Type text via Python\n   */\n  async typeText(text: string): Promise<void> {\n    await this.call('type_text', [text]);\n  }\n\n  /**\n   * Press key via Python\n   */\n  async pressKey(key: string, modifiers: string[] = []): Promise<void> {\n    await this.call('press_key', [key, modifiers]);\n  }\n\n  /**\n   * Get accessibility tree via Python\n   */\n  async getAccessibilityTree(): Promise<unknown> {\n    return this.call('get_accessibility_tree');\n  }\n\n  /**\n   * Analyze screenshot with VLM via Python\n   */\n  async analyzeVisual(screenshotBase64: string): Promise<unknown> {\n    return this.call('analyze_visual', [screenshotBase64]);\n  }\n\n  // ============================================================================\n  // Additional Desktop Control Methods\n  // ============================================================================\n\n  /**\n   * Move mouse to coordinates\n   */\n  async moveMouse(x: number, y: number): Promise<void> {\n    await this.call('move_mouse', [x, y]);\n  }\n\n  /**\n   * Double click\n   */\n  async doubleClick(x: number, y: number): Promise<void> {\n    await this.call('double_click', [x, y]);\n  }\n\n  /**\n   * Right click\n   */\n  async rightClick(x: number, y: number): Promise<void> {\n    await this.call('click', [x, y, 'right']);\n  }\n\n  /**\n   * Drag from one point to another\n   */\n  async drag(fromX: number, fromY: number, toX: number, toY: number): Promise<void> {\n    await this.call('drag', [fromX, fromY, toX, toY]);\n  }\n\n  /**\n   * Scroll\n   */\n  async scroll(x: number, y: number, deltaX: number, deltaY: number): Promise<void> {\n    await this.call('scroll', [x, y, deltaX, deltaY]);\n  }\n\n  /**\n   * Find application window\n   */\n  async findApplication(appName: string): Promise<unknown> {\n    return this.call('find_application', [appName]);\n  }\n\n  /**\n   * Activate application window\n   */\n  async activateApplication(appName: string): Promise<void> {\n    await this.call('activate_application', [appName]);\n  }\n\n  /**\n   * Get screen size\n   */\n  async getScreenSize(): Promise<{ width: number; height: number }> {\n    return this.call('get_screen_size');\n  }\n\n  /**\n   * Find element by name\n   */\n  async findElementByName(name: string, elementType?: string): Promise<unknown> {\n    return this.call('find_element_by_name', [name, elementType]);\n  }\n\n  // ============================================================================\n  // Private Methods\n  // ============================================================================\n\n  /**\n   * Wait for Python process to be ready\n   */\n  private async waitForReady(): Promise<void> {\n    return new Promise((resolve, reject) => {\n      const timeout = setTimeout(() => {\n        reject(new Error('Python bridge startup timeout'));\n      }, 10000);\n\n      const handler = (line: string) => {\n        try {\n          const data = JSON.parse(line);\n          if (data.status === 'ready') {\n            clearTimeout(timeout);\n            this.readline?.off('line', handler);\n            resolve();\n          }\n        } catch {\n          // Ignore non-JSON lines during startup\n        }\n      };\n\n      this.readline?.on('line', handler);\n    });\n  }\n\n  /**\n   * Handle response from Python process\n   */\n  private handleResponse(line: string): void {\n    try {\n      const response = JSON.parse(line);\n\n      // Skip status messages\n      if (response.status) {\n        return;\n      }\n\n      const { id, result, error } = response;\n\n      if (id && this.pendingRequests.has(id)) {\n        const { resolve, reject } = this.pendingRequests.get(id)!;\n        this.pendingRequests.delete(id);\n\n        if (error) {\n          reject(new Error(error.message || 'Python bridge error'));\n        } else {\n          resolve(result);\n        }\n      }\n    } catch (e) {\n      if (this.config.debug) {\n        console.log(`[Python Bridge] Non-JSON output: ${line}`);\n      }\n    }\n  }\n}\n","/**\n * @flowsight/desktop-test - NutJS Adapter\n *\n * Native desktop control adapter using NutJS.\n * Provides cross-platform mouse, keyboard, and screenshot capabilities.\n */\n\nimport type { NutJSConfig, NutJSAdapterInterface } from '../types.js';\n\n/**\n * Key mapping for NutJS\n */\nconst KEY_MAP: Record<string, string> = {\n  'ctrl': 'LeftControl',\n  'control': 'LeftControl',\n  'cmd': 'LeftSuper',\n  'command': 'LeftSuper',\n  'meta': 'LeftSuper',\n  'alt': 'LeftAlt',\n  'option': 'LeftAlt',\n  'shift': 'LeftShift',\n  'enter': 'Return',\n  'return': 'Return',\n  'esc': 'Escape',\n  'escape': 'Escape',\n  'backspace': 'Backspace',\n  'delete': 'Delete',\n  'tab': 'Tab',\n  'space': 'Space',\n  'up': 'Up',\n  'down': 'Down',\n  'left': 'Left',\n  'right': 'Right',\n  'home': 'Home',\n  'end': 'End',\n  'pageup': 'PageUp',\n  'pagedown': 'PageDown',\n  'insert': 'Insert',\n  'f1': 'F1', 'f2': 'F2', 'f3': 'F3', 'f4': 'F4',\n  'f5': 'F5', 'f6': 'F6', 'f7': 'F7', 'f8': 'F8',\n  'f9': 'F9', 'f10': 'F10', 'f11': 'F11', 'f12': 'F12',\n};\n\n/**\n * NutJS Adapter - native desktop control\n */\nexport class NutJSAdapter implements NutJSAdapterInterface {\n  private config: Required<NutJSConfig>;\n  private initialized: boolean = false;\n  private nut: NutJSModule | null = null;\n\n  constructor(config: NutJSConfig = {}) {\n    this.config = {\n      keyboard: config.keyboard ?? true,\n      mouse: config.mouse ?? true,\n      keyDelay: config.keyDelay ?? 50,\n      mouseSpeed: config.mouseSpeed ?? 500,\n    };\n  }\n\n  /**\n   * Initialize NutJS\n   */\n  async initialize(): Promise<void> {\n    if (this.initialized) return;\n\n    try {\n      // Dynamic import to avoid bundling issues\n      // Try @computer-use/nut-js first (newer package), fallback to @nut-tree/nut-js\n      let nutModule: NutJSModule;\n      \n      try {\n        // @ts-expect-error - Dynamic import, types not bundled\n        nutModule = await import('@computer-use/nut-js') as NutJSModule;\n      } catch {\n        try {\n          // @ts-expect-error - Dynamic import, types not bundled\n          nutModule = await import('@nut-tree/nut-js') as NutJSModule;\n        } catch {\n          throw new Error('NutJS not installed. Run: npm install @nut-tree/nut-js');\n        }\n      }\n\n      this.nut = nutModule;\n\n      // Configure\n      if (this.nut.keyboard) {\n        this.nut.keyboard.config.autoDelayMs = this.config.keyDelay;\n      }\n      if (this.nut.mouse) {\n        this.nut.mouse.config.mouseSpeed = this.config.mouseSpeed;\n      }\n\n      this.initialized = true;\n    } catch (error: unknown) {\n      // NutJS is optional - fall back gracefully\n      const message = error instanceof Error ? error.message : String(error);\n      console.warn(`[NutJS Adapter] Not available: ${message}`);\n      this.initialized = false;\n    }\n  }\n\n  /**\n   * Cleanup\n   */\n  async cleanup(): Promise<void> {\n    this.initialized = false;\n    this.nut = null;\n  }\n\n  /**\n   * Check if NutJS is available\n   */\n  isAvailable(): boolean {\n    return this.initialized && this.nut !== null;\n  }\n\n  /**\n   * Click at coordinates\n   */\n  async click(\n    x: number,\n    y: number,\n    button: 'left' | 'right' | 'middle' = 'left',\n    count: number = 1\n  ): Promise<void> {\n    if (!this.isAvailable() || !this.nut) {\n      throw new Error('NutJS not available');\n    }\n\n    const { mouse, Button, Point } = this.nut;\n\n    await mouse.setPosition(new Point(x, y));\n\n    const mouseButton = button === 'right' ? Button.RIGHT :\n                        button === 'middle' ? Button.MIDDLE : Button.LEFT;\n\n    for (let i = 0; i < count; i++) {\n      await mouse.click(mouseButton);\n      if (i < count - 1) {\n        await this.sleep(50);\n      }\n    }\n  }\n\n  /**\n   * Move mouse to coordinates\n   */\n  async moveTo(x: number, y: number): Promise<void> {\n    if (!this.isAvailable() || !this.nut) {\n      throw new Error('NutJS not available');\n    }\n\n    const { mouse, Point } = this.nut;\n    await mouse.move([new Point(x, y)]);\n  }\n\n  /**\n   * Type text\n   */\n  async type(text: string, delay?: number): Promise<void> {\n    if (!this.isAvailable() || !this.nut) {\n      throw new Error('NutJS not available');\n    }\n\n    const { keyboard } = this.nut;\n\n    if (delay) {\n      keyboard.config.autoDelayMs = delay;\n    }\n\n    await keyboard.type(text);\n\n    if (delay) {\n      keyboard.config.autoDelayMs = this.config.keyDelay;\n    }\n  }\n\n  /**\n   * Press key or key combination\n   */\n  async press(key: string): Promise<void> {\n    if (!this.isAvailable() || !this.nut) {\n      throw new Error('NutJS not available');\n    }\n\n    const { keyboard, Key } = this.nut;\n\n    // Parse key combination (e.g., \"Control+a\", \"Meta+Shift+s\")\n    const parts = key.split('+');\n    const keys: number[] = [];\n\n    for (const part of parts) {\n      const normalizedKey = this.normalizeKey(part.trim());\n      const nutKey = Key[normalizedKey as keyof typeof Key];\n      if (nutKey !== undefined) {\n        keys.push(nutKey);\n      }\n    }\n\n    if (keys.length === 0) {\n      throw new Error(`Unknown key: ${key}`);\n    }\n\n    if (keys.length === 1) {\n      await keyboard.pressKey(keys[0]);\n      await keyboard.releaseKey(keys[0]);\n    } else {\n      // Hold modifiers, press main key, release all\n      const modifiers = keys.slice(0, -1);\n      const mainKey = keys[keys.length - 1];\n\n      for (const mod of modifiers) {\n        await keyboard.pressKey(mod);\n      }\n      await keyboard.pressKey(mainKey);\n      await keyboard.releaseKey(mainKey);\n      for (const mod of modifiers.reverse()) {\n        await keyboard.releaseKey(mod);\n      }\n    }\n  }\n\n  /**\n   * Scroll\n   */\n  async scroll(direction: 'up' | 'down' | 'left' | 'right', amount: number): Promise<void> {\n    if (!this.isAvailable() || !this.nut) {\n      throw new Error('NutJS not available');\n    }\n\n    const { mouse } = this.nut;\n\n    switch (direction) {\n      case 'up':\n        await mouse.scrollUp(amount);\n        break;\n      case 'down':\n        await mouse.scrollDown(amount);\n        break;\n      case 'left':\n        await mouse.scrollLeft(amount);\n        break;\n      case 'right':\n        await mouse.scrollRight(amount);\n        break;\n    }\n  }\n\n  /**\n   * Drag from one point to another\n   */\n  async drag(fromX: number, fromY: number, toX: number, toY: number): Promise<void> {\n    if (!this.isAvailable() || !this.nut) {\n      throw new Error('NutJS not available');\n    }\n\n    const { mouse, Point } = this.nut;\n\n    await mouse.setPosition(new Point(fromX, fromY));\n    await mouse.drag([new Point(toX, toY)]);\n  }\n\n  /**\n   * Take screenshot and return base64\n   */\n  async screenshot(): Promise<string> {\n    if (!this.isAvailable() || !this.nut) {\n      throw new Error('NutJS not available');\n    }\n\n    const { screen } = this.nut;\n\n    // Import Jimp dynamically\n    const { Jimp } = await import('jimp');\n\n    const capture = await screen.capture();\n    const image = new Jimp({\n      width: capture.width,\n      height: capture.height,\n      data: Buffer.from(capture.data),\n    });\n\n    const buffer = await image.getBuffer('image/jpeg', { quality: 75 });\n    return buffer.toString('base64');\n  }\n\n  /**\n   * Get screen size\n   */\n  async getScreenSize(): Promise<{ width: number; height: number }> {\n    if (!this.isAvailable() || !this.nut) {\n      throw new Error('NutJS not available');\n    }\n\n    const { screen } = this.nut;\n    const size = await screen.size();\n    return { width: size.width, height: size.height };\n  }\n\n  // ============================================================================\n  // Private Helpers\n  // ============================================================================\n\n  private normalizeKey(key: string): string {\n    const lower = key.toLowerCase();\n    if (KEY_MAP[lower]) {\n      return KEY_MAP[lower];\n    }\n\n    // Single letter key\n    if (key.length === 1) {\n      return key.toUpperCase();\n    }\n\n    // Return as-is (capitalized)\n    return key.charAt(0).toUpperCase() + key.slice(1);\n  }\n\n  private sleep(ms: number): Promise<void> {\n    return new Promise(resolve => setTimeout(resolve, ms));\n  }\n}\n\n// ============================================================================\n// Type definitions for NutJS module\n// ============================================================================\n\ninterface NutJSModule {\n  mouse: {\n    config: { mouseSpeed: number };\n    setPosition: (point: NutPoint) => Promise<void>;\n    move: (path: NutPoint[]) => Promise<void>;\n    click: (button: number) => Promise<void>;\n    drag: (path: NutPoint[]) => Promise<void>;\n    scrollUp: (amount: number) => Promise<void>;\n    scrollDown: (amount: number) => Promise<void>;\n    scrollLeft: (amount: number) => Promise<void>;\n    scrollRight: (amount: number) => Promise<void>;\n  };\n  keyboard: {\n    config: { autoDelayMs: number };\n    type: (text: string) => Promise<void>;\n    pressKey: (key: number) => Promise<void>;\n    releaseKey: (key: number) => Promise<void>;\n  };\n  screen: {\n    capture: () => Promise<{ width: number; height: number; data: Uint8Array }>;\n    size: () => Promise<{ width: number; height: number }>;\n  };\n  Button: {\n    LEFT: number;\n    RIGHT: number;\n    MIDDLE: number;\n  };\n  Key: Record<string, number>;\n  Point: new (x: number, y: number) => NutPoint;\n}\n\ninterface NutPoint {\n  x: number;\n  y: number;\n}\n","/**\n * @flowsight/desktop-test - VLM Cost Tracker\n *\n * Tracks API usage and estimates costs across different VLM providers.\n */\n\nimport {\n  VLMProvider,\n  type CostEntry,\n  type CostSummary,\n} from '../types.js';\n\n/**\n * Pricing information per provider (as of 2024)\n * Prices in USD per unit\n */\nconst PRICING: Record<string, {\n  inputTokenPrice: number;      // per 1K tokens\n  outputTokenPrice: number;     // per 1K tokens\n  imagePrice: number;           // per image\n}> = {\n  [VLMProvider.ANTHROPIC]: {\n    inputTokenPrice: 0.003,     // Claude 3.5 Sonnet\n    outputTokenPrice: 0.015,\n    imagePrice: 0.0048,         // ~1280x1280 image\n  },\n  [VLMProvider.OPENAI]: {\n    inputTokenPrice: 0.005,     // GPT-4o\n    outputTokenPrice: 0.015,\n    imagePrice: 0.00765,        // high detail\n  },\n  [VLMProvider.VOLCENGINE]: {\n    inputTokenPrice: 0.0008,    // Doubao Pro (Chinese pricing)\n    outputTokenPrice: 0.002,\n    imagePrice: 0.001,\n  },\n  [VLMProvider.DOUBAO]: {\n    inputTokenPrice: 0.0008,\n    outputTokenPrice: 0.002,\n    imagePrice: 0.001,\n  },\n  // Default/fallback pricing\n  default: {\n    inputTokenPrice: 0.003,\n    outputTokenPrice: 0.015,\n    imagePrice: 0.005,\n  },\n};\n\n/**\n * Cost Tracker - monitors VLM API usage and costs\n */\nexport class CostTracker {\n  private entries: CostEntry[] = [];\n  private customPricing: Record<string, typeof PRICING[string]> = {};\n\n  /**\n   * Set custom pricing for a provider\n   */\n  setPricing(provider: string, pricing: typeof PRICING[string]): void {\n    this.customPricing[provider] = pricing;\n  }\n\n  /**\n   * Get pricing for a provider\n   */\n  private getPricing(provider: string): typeof PRICING[string] {\n    return this.customPricing[provider] || PRICING[provider] || PRICING.default;\n  }\n\n  /**\n   * Track a VLM API call\n   */\n  track(entry: {\n    provider: VLMProvider | string;\n    model: string;\n    inputTokens: number;\n    outputTokens: number;\n    images?: number;\n    operation: CostEntry['operation'];\n  }): CostEntry {\n    const pricing = this.getPricing(entry.provider);\n    const images = entry.images || 1;\n\n    const cost =\n      (entry.inputTokens / 1000) * pricing.inputTokenPrice +\n      (entry.outputTokens / 1000) * pricing.outputTokenPrice +\n      images * pricing.imagePrice;\n\n    const costEntry: CostEntry = {\n      provider: entry.provider,\n      model: entry.model,\n      inputTokens: entry.inputTokens,\n      outputTokens: entry.outputTokens,\n      images,\n      cost,\n      timestamp: Date.now(),\n      operation: entry.operation,\n    };\n\n    this.entries.push(costEntry);\n    return costEntry;\n  }\n\n  /**\n   * Estimate cost for a potential call (without tracking)\n   */\n  estimate(entry: {\n    provider: VLMProvider | string;\n    inputTokens: number;\n    outputTokens: number;\n    images?: number;\n  }): number {\n    const pricing = this.getPricing(entry.provider);\n    const images = entry.images || 1;\n\n    return (\n      (entry.inputTokens / 1000) * pricing.inputTokenPrice +\n      (entry.outputTokens / 1000) * pricing.outputTokenPrice +\n      images * pricing.imagePrice\n    );\n  }\n\n  /**\n   * Get cost summary\n   */\n  getSummary(): CostSummary {\n    const byProvider: Record<string, number> = {};\n    const byOperation: Record<string, number> = {};\n\n    for (const entry of this.entries) {\n      byProvider[entry.provider] = (byProvider[entry.provider] || 0) + entry.cost;\n      byOperation[entry.operation] = (byOperation[entry.operation] || 0) + entry.cost;\n    }\n\n    return {\n      totalCost: this.entries.reduce((sum, e) => sum + e.cost, 0),\n      totalCalls: this.entries.length,\n      byProvider,\n      byOperation,\n      entries: [...this.entries],\n    };\n  }\n\n  /**\n   * Get recent entries\n   */\n  getRecentEntries(count: number = 10): CostEntry[] {\n    return this.entries.slice(-count);\n  }\n\n  /**\n   * Reset tracking\n   */\n  reset(): void {\n    this.entries = [];\n  }\n\n  /**\n   * Export to JSON\n   */\n  toJSON(): string {\n    return JSON.stringify(this.getSummary(), null, 2);\n  }\n\n  /**\n   * Print summary to console\n   */\n  printSummary(): void {\n    const summary = this.getSummary();\n\n    console.log('\\n=== VLM Cost Summary ===');\n    console.log(`Total Cost: $${summary.totalCost.toFixed(4)}`);\n    console.log(`Total Calls: ${summary.totalCalls}`);\n\n    if (Object.keys(summary.byProvider).length > 0) {\n      console.log('\\nBy Provider:');\n      for (const [provider, cost] of Object.entries(summary.byProvider)) {\n        console.log(`  ${provider}: $${cost.toFixed(4)}`);\n      }\n    }\n\n    if (Object.keys(summary.byOperation).length > 0) {\n      console.log('\\nBy Operation:');\n      for (const [operation, cost] of Object.entries(summary.byOperation)) {\n        console.log(`  ${operation}: $${cost.toFixed(4)}`);\n      }\n    }\n\n    console.log('========================\\n');\n  }\n}\n","/**\n * @flowsight/desktop-test - Cursor Bridge\n *\n * Enables VLM functionality using Cursor's built-in Claude model.\n * When tests run within a Cursor Agent context, visual analysis\n * requests are automatically processed by the current Claude session.\n */\n\nimport * as fs from 'fs';\nimport * as path from 'path';\n\nimport type {\n  VLMConfig,\n  VLMFindRequest,\n  VLMFindResponse,\n  VLMActionRequest,\n  VLMActionResponse,\n  VLMAssertRequest,\n  VLMAssertResponse,\n  CostSummary,\n} from '../types.js';\n\n/**\n * Detected Claude Agent environment\n */\nexport type AgentEnvironment = \n  | 'cursor'           // Cursor IDE\n  | 'claude-code'      // Claude Code CLI (terminal)\n  | 'vscode-claude'    // VSCode Claude plugin\n  | 'claude-desktop'   // Claude Desktop app\n  | 'anthropic-mcp'    // Generic MCP environment\n  | 'unknown';         // Unknown but likely agent context\n\n/**\n * Detect which Claude Agent environment we're running in\n */\nexport function detectAgentEnvironment(): AgentEnvironment | null {\n  // 1. Cursor IDE\n  if (\n    process.env.CURSOR_SESSION ||\n    process.env.CURSOR_WORKSPACE ||\n    process.env.CURSOR_IDE ||\n    process.env.CURSOR_TRACE_ID\n  ) {\n    return 'cursor';\n  }\n\n  // 2. Claude Code CLI (terminal)\n  if (\n    process.env.CLAUDE_CODE ||\n    process.env.CLAUDE_CLI ||\n    process.env.ANTHROPIC_AGENT ||\n    process.env.CLAUDE_SESSION_ID\n  ) {\n    return 'claude-code';\n  }\n\n  // 3. VSCode Claude plugin\n  if (\n    process.env.VSCODE_CLAUDE ||\n    process.env.CLAUDE_VSCODE ||\n    process.env.VSCODE_PID && process.env.ANTHROPIC_API_KEY === undefined\n  ) {\n    return 'vscode-claude';\n  }\n\n  // 4. Claude Desktop app\n  if (\n    process.env.CLAUDE_DESKTOP ||\n    process.env.CLAUDE_APP\n  ) {\n    return 'claude-desktop';\n  }\n\n  // 5. Generic MCP environment\n  if (\n    process.env.MCP_SERVER ||\n    process.env.MCP_SESSION\n  ) {\n    return 'anthropic-mcp';\n  }\n\n  // 6. Check if running in TTY with common agent indicators\n  if (\n    process.stdout.isTTY === false &&\n    (process.env.TERM_PROGRAM === 'vscode' || \n     process.env.TERM === 'xterm-256color')\n  ) {\n    return 'unknown';\n  }\n\n  // 7. Explicit flag from user\n  if (process.env.USE_AGENT_MODE === 'true') {\n    return 'unknown';\n  }\n\n  return null;\n}\n\n/**\n * Check if we should use Agent mode (any Claude environment)\n */\nexport function shouldUseAgentMode(): boolean {\n  return detectAgentEnvironment() !== null || \n         process.env.USE_CURSOR === 'true' ||\n         process.env.USE_AGENT_MODE === 'true';\n}\n\n/**\n * Agent Bridge - Works with any Claude Agent environment\n * \n * Supports:\n * - Cursor IDE\n * - Claude Code CLI (terminal)\n * - VSCode Claude plugin\n * - Claude Desktop\n * - Any MCP-enabled environment\n *\n * This bridge outputs structured requests that the Agent processes,\n * using the model available in the current session.\n */\nexport class CursorBridge {\n  private screenshotDir: string;\n  private requestCount = 0;\n  private environment: AgentEnvironment;\n\n  constructor(_config: VLMConfig) {\n    this.environment = detectAgentEnvironment() || 'unknown';\n    this.screenshotDir = path.join(process.cwd(), '.agent-test-screenshots');\n\n    // Ensure screenshot directory exists\n    if (!fs.existsSync(this.screenshotDir)) {\n      fs.mkdirSync(this.screenshotDir, { recursive: true });\n    }\n\n    // Log detected environment\n    console.log(` Agent Bridge initialized (environment: ${this.environment})`);\n  }\n\n  /**\n   * Get the detected agent environment\n   */\n  getEnvironment(): AgentEnvironment {\n    return this.environment;\n  }\n\n  /**\n   * Save screenshot and return path\n   */\n  private saveScreenshot(base64Data: string): string {\n    this.requestCount++;\n    const filename = `screenshot_${Date.now()}_${this.requestCount}.png`;\n    const filepath = path.join(this.screenshotDir, filename);\n\n    // Remove data URL prefix if present\n    const cleanData = base64Data.replace(/^data:image\\/\\w+;base64,/, '');\n    fs.writeFileSync(filepath, Buffer.from(cleanData, 'base64'));\n\n    return filepath;\n  }\n\n  /**\n   * Find element using Cursor's Claude\n   */\n  async findElement(request: VLMFindRequest): Promise<VLMFindResponse> {\n    const screenshotPath = this.saveScreenshot(request.screenshot);\n\n    // Create analysis request file for Agent to process\n    const analysisRequest = {\n      type: 'find_element',\n      screenshot: screenshotPath,\n      description: request.description,\n      context: request.context,\n      timestamp: new Date().toISOString(),\n    };\n\n    const requestFile = path.join(\n      this.screenshotDir,\n      `request_${Date.now()}.json`\n    );\n    fs.writeFileSync(requestFile, JSON.stringify(analysisRequest, null, 2));\n\n    // Output for Agent processing\n    console.log('\\n');\n    console.log('  CURSOR VLM REQUEST: Find Element                     ');\n    console.log('');\n    console.log(` Screenshot: ${screenshotPath}`);\n    console.log(` Target: \"${request.description}\"`);\n    if (request.context) {\n      console.log(` Context: ${request.context}`);\n    }\n    console.log('');\n    console.log(' Please analyze the screenshot and provide coordinates   ');\n    console.log(' or set CURSOR_VLM_RESPONSE env var with JSON response   ');\n    console.log('\\n');\n\n    // Check for pre-set response (for automated scenarios)\n    if (process.env.CURSOR_VLM_RESPONSE) {\n      try {\n        const response = JSON.parse(process.env.CURSOR_VLM_RESPONSE);\n        delete process.env.CURSOR_VLM_RESPONSE;\n        return response as VLMFindResponse;\n      } catch {\n        // Continue with default response\n      }\n    }\n\n    // Check for response file\n    const responseFile = requestFile.replace('request_', 'response_');\n    if (fs.existsSync(responseFile)) {\n      const response = JSON.parse(fs.readFileSync(responseFile, 'utf-8'));\n      return response as VLMFindResponse;\n    }\n\n    // Default: return not found (Agent should intercept and handle)\n    return {\n      confidence: 0,\n      reasoning: 'Waiting for Cursor Agent to analyze screenshot',\n      notFound: true,\n      alternative: 'Use MCP browser tools or provide manual coordinates',\n    };\n  }\n\n  /**\n   * Get next action using Cursor's Claude\n   */\n  async getNextAction(request: VLMActionRequest): Promise<VLMActionResponse> {\n    const screenshotPath = this.saveScreenshot(request.screenshot);\n\n    // Output structured request\n    console.log('\\n');\n    console.log('  CURSOR VLM REQUEST: Get Next Action                  ');\n    console.log('');\n    console.log(` Screenshot: ${screenshotPath}`);\n    console.log(` Instruction: \"${request.instruction}\"`);\n    console.log(' Available Actions:');\n    request.actionSpaces.slice(0, 5).forEach((action) => {\n      console.log(`   - ${action}`);\n    });\n    console.log('\\n');\n\n    // Check for pre-set response\n    if (process.env.CURSOR_VLM_RESPONSE) {\n      try {\n        const response = JSON.parse(process.env.CURSOR_VLM_RESPONSE);\n        delete process.env.CURSOR_VLM_RESPONSE;\n        return response as VLMActionResponse;\n      } catch {\n        // Continue\n      }\n    }\n\n    return {\n      actionType: 'wait',\n      actionParams: {},\n      thought: 'Waiting for Cursor Agent to provide action',\n      finished: false,\n    };\n  }\n\n  /**\n   * Visual assertion using Cursor's Claude\n   */\n  async assertVisual(request: VLMAssertRequest): Promise<VLMAssertResponse> {\n    const screenshotPath = this.saveScreenshot(request.screenshot);\n\n    // Output structured request\n    console.log('\\n');\n    console.log('  CURSOR VLM REQUEST: Visual Assertion                 ');\n    console.log('');\n    console.log(` Screenshot: ${screenshotPath}`);\n    console.log(` Assertion: \"${request.assertion}\"`);\n    if (request.expected) {\n      console.log(` Expected: ${request.expected}`);\n    }\n    console.log('');\n    console.log(' Please verify the assertion and respond with:           ');\n    console.log(' { \"passed\": true/false, \"reasoning\": \"...\", \"actual\": \"...\" }');\n    console.log('\\n');\n\n    // Check for pre-set response\n    if (process.env.CURSOR_VLM_RESPONSE) {\n      try {\n        const response = JSON.parse(process.env.CURSOR_VLM_RESPONSE);\n        delete process.env.CURSOR_VLM_RESPONSE;\n        return response as VLMAssertResponse;\n      } catch {\n        // Continue\n      }\n    }\n\n    // For automated testing, try to use simple heuristics\n    // In real usage, the Cursor Agent should intercept and handle\n    return {\n      passed: false,\n      reasoning: 'Waiting for Cursor Agent to verify assertion',\n      actual: 'Pending verification',\n    };\n  }\n\n  /**\n   * Get cost summary (Cursor mode is free - uses existing subscription)\n   */\n  getCostSummary(): CostSummary {\n    return {\n      totalCost: 0, // Cursor mode is free (uses existing subscription)\n      totalCalls: this.requestCount,\n      byProvider: { cursor: 0 },\n      byOperation: { find: 0, action: 0, assert: 0 },\n      entries: [],\n    };\n  }\n}\n\n/**\n * Create an automated Cursor VLM handler for use in Agent context\n *\n * This function can be called by the Cursor Agent to process VLM requests\n * that were output by the test framework.\n */\nexport async function handleCursorVLMRequest(\n  requestPath: string,\n  analyzeImage: (imagePath: string, prompt: string) => Promise<string>\n): Promise<void> {\n  if (!fs.existsSync(requestPath)) {\n    throw new Error(`Request file not found: ${requestPath}`);\n  }\n\n  const request = JSON.parse(fs.readFileSync(requestPath, 'utf-8'));\n  const responsePath = requestPath.replace('request_', 'response_');\n\n  let response: VLMFindResponse | VLMActionResponse | VLMAssertResponse;\n\n  switch (request.type) {\n    case 'find_element': {\n      const prompt = `Look at this screenshot and find the element described as: \"${request.description}\"\n${request.context ? `Context: ${request.context}` : ''}\n\nReturn a JSON object with:\n- coordinates: { x: number, y: number } - the center point of the element\n- confidence: number (0-1) - how confident you are\n- reasoning: string - explanation\n- notFound: boolean - true if element cannot be found`;\n\n      const result = await analyzeImage(request.screenshot, prompt);\n      response = JSON.parse(result) as VLMFindResponse;\n      break;\n    }\n\n    case 'get_action': {\n      const prompt = `Look at this screenshot and determine the next action for: \"${request.instruction}\"\n\nAvailable actions: ${request.actionSpaces?.join(', ')}\n\nReturn a JSON object with:\n- actionType: string\n- actionParams: object\n- thought: string\n- finished: boolean`;\n\n      const result = await analyzeImage(request.screenshot, prompt);\n      response = JSON.parse(result) as VLMActionResponse;\n      break;\n    }\n\n    case 'assert_visual': {\n      const prompt = `Look at this screenshot and verify: \"${request.assertion}\"\n${request.expected ? `Expected: ${request.expected}` : ''}\n\nReturn a JSON object with:\n- passed: boolean\n- reasoning: string\n- actual: string (what you actually observed)`;\n\n      const result = await analyzeImage(request.screenshot, prompt);\n      response = JSON.parse(result) as VLMAssertResponse;\n      break;\n    }\n\n    default:\n      throw new Error(`Unknown request type: ${request.type}`);\n  }\n\n  fs.writeFileSync(responsePath, JSON.stringify(response, null, 2));\n  console.log(` Response written to: ${responsePath}`);\n}\n","/**\n * @flowsight/desktop-test - VLM Client\n *\n * Unified client for Vision-Language Models (Claude, GPT-4V, Doubao, etc.)\n * Used for visual element finding and intelligent UI understanding.\n */\n\nimport {\n  VLMProvider,\n  type VLMConfig,\n  type VLMFindRequest,\n  type VLMFindResponse,\n  type VLMActionRequest,\n  type VLMActionResponse,\n  type VLMAssertRequest,\n  type VLMAssertResponse,\n  type CostSummary,\n  type VLMClientInterface,\n} from '../types.js';\n\nimport { CostTracker } from './cost-tracker.js';\nimport { CursorBridge, shouldUseAgentMode, detectAgentEnvironment } from './cursor-bridge.js';\n\n/**\n * Default models for each provider\n */\nconst DEFAULT_MODELS: Record<string, string> = {\n  [VLMProvider.ANTHROPIC]: 'claude-sonnet-4-20250514',\n  [VLMProvider.OPENAI]: 'gpt-4o',\n  [VLMProvider.VOLCENGINE]: 'doubao-1-5-vision-pro',\n  [VLMProvider.DOUBAO]: 'doubao-1-5-vision-pro',\n  [VLMProvider.CURSOR]: 'claude-opus-4-5', // Uses Cursor's built-in model\n};\n\n/**\n * VLM Client - provides unified access to various VLM providers\n */\nexport class VLMClient implements VLMClientInterface {\n  private config: VLMConfig;\n  private provider: VLMProvider;\n  private model: string;\n  private costTracker: CostTracker;\n  private cursorBridge?: CursorBridge;\n\n  constructor(config: VLMConfig) {\n    this.config = config;\n    this.provider = this.normalizeProvider(config.provider);\n    this.model = config.model || DEFAULT_MODELS[this.provider] || 'gpt-4o';\n    this.costTracker = new CostTracker();\n\n    // Auto-detect agent environment if no API key provided\n    const shouldAutoUseAgent = \n      this.provider === VLMProvider.CURSOR ||\n      (shouldUseAgentMode() && !config.apiKey && !process.env.ANTHROPIC_API_KEY && !process.env.OPENAI_API_KEY);\n\n    if (shouldAutoUseAgent) {\n      this.cursorBridge = new CursorBridge(config);\n      this.provider = VLMProvider.CURSOR;\n      \n      const env = detectAgentEnvironment();\n      if (env && env !== 'cursor') {\n        console.log(` Auto-detected ${env} environment, using Agent mode`);\n      }\n    }\n  }\n\n  /**\n   * Check if using Agent mode\n   */\n  isUsingAgentMode(): boolean {\n    return this.cursorBridge !== undefined;\n  }\n\n  /**\n   * Get detected agent environment\n   */\n  getAgentEnvironment(): string | null {\n    return this.cursorBridge?.getEnvironment() || null;\n  }\n\n  private normalizeProvider(provider: VLMProvider | string): VLMProvider {\n    if (typeof provider === 'string') {\n      const normalized = provider.toLowerCase();\n      if (normalized === 'anthropic' || normalized === 'claude') {\n        return VLMProvider.ANTHROPIC;\n      }\n      if (normalized === 'openai' || normalized === 'gpt') {\n        return VLMProvider.OPENAI;\n      }\n      if (normalized === 'volcengine' || normalized === 'volc') {\n        return VLMProvider.VOLCENGINE;\n      }\n      if (normalized === 'doubao') {\n        return VLMProvider.DOUBAO;\n      }\n      if (normalized === 'cursor') {\n        return VLMProvider.CURSOR;\n      }\n      // 'agent' or 'auto' - auto-detect any Claude environment\n      if (normalized === 'agent' || normalized === 'auto') {\n        return VLMProvider.CURSOR; // Will use CursorBridge for all agent environments\n      }\n      return VLMProvider.CUSTOM;\n    }\n    return provider;\n  }\n\n  /**\n   * Find element by visual description\n   */\n  async findElement(request: VLMFindRequest): Promise<VLMFindResponse> {\n    // Use Cursor bridge if configured\n    if (this.cursorBridge) {\n      return this.cursorBridge.findElement(request);\n    }\n\n    const systemPrompt = `You are a GUI automation assistant. Your task is to find UI elements in screenshots.\n\nGiven a screenshot and an element description, you need to:\n1. Locate the described element in the screenshot\n2. Return the center coordinates (x, y) of the element\n3. Provide your confidence level (0-1)\n4. Explain your reasoning\n\nIf the element cannot be found, set notFound to true and suggest alternatives.\n\nIMPORTANT: Return coordinates in the format that can be used for clicking.\nThe screenshot dimensions will be provided.`;\n\n    const userPrompt = `Find the following element in the screenshot:\n\"${request.description}\"\n\n${request.context ? `Context: ${request.context}` : ''}\n\nReturn a JSON object with:\n- coordinates: { x: number, y: number } or null if not found\n- confidence: number (0-1)\n- reasoning: string\n- notFound: boolean\n- alternative: string (if not found, suggest what similar element exists)`;\n\n    const response = await this.callVLM(systemPrompt, userPrompt, request.screenshot, 'find');\n\n    try {\n      const parsed = this.parseJSON(response);\n      const coordinates = parsed.coordinates as { x: number; y: number } | undefined;\n      return {\n        coordinates,\n        confidence: (parsed.confidence as number) || 0,\n        reasoning: (parsed.reasoning as string) || '',\n        notFound: (parsed.notFound as boolean) || !coordinates,\n        alternative: parsed.alternative as string | undefined,\n      };\n    } catch {\n      return {\n        confidence: 0,\n        reasoning: 'Failed to parse VLM response',\n        notFound: true,\n      };\n    }\n  }\n\n  /**\n   * Get next action to perform\n   */\n  async getNextAction(request: VLMActionRequest): Promise<VLMActionResponse> {\n    // Use Cursor bridge if configured\n    if (this.cursorBridge) {\n      return this.cursorBridge.getNextAction(request);\n    }\n\n    const systemPrompt = `You are a GUI automation agent. Your task is to control a desktop application to complete user instructions.\n\nAvailable actions:\n${request.actionSpaces.join('\\n')}\n\nFor each step:\n1. Analyze the current screenshot\n2. Decide the best action to take\n3. Return the action with parameters\n\nWhen the task is complete, return finished: true.\n\nIMPORTANT: \n- Think step by step\n- Only perform one action at a time\n- Be precise with coordinates`;\n\n    const userPrompt = `Instruction: \"${request.instruction}\"\n\nBased on the current screenshot, what action should be taken next?\n\nReturn a JSON object with:\n- actionType: string (one of the available actions)\n- actionParams: object (parameters for the action)\n- thought: string (your reasoning)\n- reflection: string (any observations)\n- finished: boolean (true if task is complete)`;\n\n    const response = await this.callVLM(systemPrompt, userPrompt, request.screenshot, 'action');\n\n    try {\n      const parsed = this.parseJSON(response);\n      return {\n        actionType: (parsed.actionType as string) || 'wait',\n        actionParams: (parsed.actionParams as Record<string, unknown>) || {},\n        thought: (parsed.thought as string) || '',\n        reflection: parsed.reflection as string | undefined,\n        finished: (parsed.finished as boolean) || false,\n      };\n    } catch {\n      return {\n        actionType: 'wait',\n        actionParams: {},\n        thought: 'Failed to parse VLM response',\n        finished: false,\n      };\n    }\n  }\n\n  /**\n   * Perform visual assertion\n   */\n  async assertVisual(request: VLMAssertRequest): Promise<VLMAssertResponse> {\n    // Use Cursor bridge if configured\n    if (this.cursorBridge) {\n      return this.cursorBridge.assertVisual(request);\n    }\n\n    const systemPrompt = `You are a QA automation assistant. Your task is to verify UI states and conditions.\n\nGiven a screenshot and an assertion, you need to:\n1. Analyze the screenshot carefully\n2. Determine if the assertion is true or false\n3. Provide detailed reasoning\n4. If the assertion fails, suggest how to fix it`;\n\n    const userPrompt = `Assertion: \"${request.assertion}\"\n\n${request.expected ? `Expected: ${request.expected}` : ''}\n\nAnalyze the screenshot and verify the assertion.\n\nReturn a JSON object with:\n- passed: boolean\n- reasoning: string (detailed explanation)\n- actual: string (what you actually observed)\n- suggestions: string[] (if failed, how to fix)`;\n\n    const response = await this.callVLM(systemPrompt, userPrompt, request.screenshot, 'assert');\n\n    try {\n      const parsed = this.parseJSON(response);\n      return {\n        passed: (parsed.passed as boolean) || false,\n        reasoning: (parsed.reasoning as string) || '',\n        actual: (parsed.actual as string) || '',\n        suggestions: parsed.suggestions as string[] | undefined,\n      };\n    } catch {\n      return {\n        passed: false,\n        reasoning: 'Failed to parse VLM response',\n        actual: 'Unknown',\n      };\n    }\n  }\n\n  /**\n   * Compare two screenshots and find differences (from Python framework)\n   * Note: Currently uses single image analysis. For true comparison, \n   * both images should be sent to the VLM.\n   */\n  async compareScreenshots(\n    screenshot1: string,\n    _screenshot2: string,\n    context?: string\n  ): Promise<{\n    differences: Array<{ type: string; description: string; severity: string }>;\n    summary: string;\n    similarityScore: number;\n  }> {\n    const systemPrompt = `You are a UI testing assistant. Compare two screenshots and identify all differences.`;\n\n    const userPrompt = `Compare these two screenshots and identify differences.\n${context ? `Context: ${context}` : ''}\n\nReturn a JSON object with:\n- differences: array of { type: \"added|removed|changed|moved\", description: string, severity: \"high|medium|low\" }\n- summary: string (overall summary)\n- similarityScore: number (0-1, how similar they are)`;\n\n    // For this we need to send both images - simplified version\n    const response = await this.callVLM(systemPrompt, userPrompt, screenshot1, 'assert');\n\n    try {\n      const parsed = this.parseJSON(response);\n      return {\n        differences: (parsed.differences as Array<{ type: string; description: string; severity: string }>) || [],\n        summary: (parsed.summary as string) || '',\n        similarityScore: (parsed.similarityScore as number) || 0,\n      };\n    } catch {\n      return {\n        differences: [],\n        summary: 'Failed to parse response',\n        similarityScore: 0,\n      };\n    }\n  }\n\n  /**\n   * Detect visual issues in screenshot (from Python framework)\n   */\n  async detectVisualIssues(screenshot: string): Promise<Array<{\n    type: string;\n    severity: string;\n    description: string;\n    location?: { x: number; y: number; width: number; height: number };\n    suggestion?: string;\n  }>> {\n    const systemPrompt = `You are a UI quality assurance expert. Detect visual issues and UI defects.`;\n\n    const userPrompt = `Analyze this screenshot for visual issues and UI defects.\n\nCheck for:\n1. Text truncation or overflow\n2. Element overlap\n3. Alignment issues\n4. Color contrast problems\n5. Blurry or distorted elements\n6. Inconsistent spacing\n7. Layout errors\n\nReturn a JSON object with:\n{\n  \"issues\": [\n    {\n      \"type\": \"text_truncation|overlap|misalignment|contrast|blur|spacing|layout\",\n      \"severity\": \"critical|high|medium|low\",\n      \"description\": \"description of the issue\",\n      \"location\": {\"x\": 100, \"y\": 200, \"width\": 50, \"height\": 20},\n      \"suggestion\": \"how to fix it\"\n    }\n  ]\n}`;\n\n    const response = await this.callVLM(systemPrompt, userPrompt, screenshot, 'assert');\n\n    try {\n      const parsed = this.parseJSON(response);\n      return (parsed.issues as Array<{\n        type: string;\n        severity: string;\n        description: string;\n        location?: { x: number; y: number; width: number; height: number };\n        suggestion?: string;\n      }>) || [];\n    } catch {\n      return [];\n    }\n  }\n\n  /**\n   * Analyze IDE screenshot with specialized prompts (from Python framework)\n   */\n  async analyzeIDEScreenshot(screenshot: string): Promise<{\n    elements: Array<{\n      elementType: string;\n      text?: string;\n      bounds: { x: number; y: number; width: number; height: number };\n      attributes?: Record<string, unknown>;\n    }>;\n    layoutStructure: {\n      type: string;\n      sidebarWidth?: number;\n      editorArea?: { x: number; y: number; width: number; height: number };\n      panels?: string[];\n    };\n    colorScheme: 'dark' | 'light';\n    issues: string[];\n  }> {\n    const systemPrompt = `You are an IDE interface analysis expert. Analyze IDE screenshots to identify all UI elements.\n\nIDE common element types:\n- menu: Menu bar (File, Edit, View, etc.)\n- sidebar: Sidebar (file tree, outline, etc.)\n- editor: Code editor area\n- tab: Tab pages\n- toolbar: Toolbar\n- statusbar: Status bar\n- panel: Panels (terminal, output, etc.)\n- button: Buttons (run, debug, settings, etc.)\n- icon: Icons\n- input: Input fields, search boxes\n- dropdown: Dropdown menus\n- tooltip: Tooltips`;\n\n    const userPrompt = `Analyze this IDE screenshot and identify all interface elements.\n\nReturn a JSON object with:\n{\n  \"elements\": [\n    {\n      \"elementType\": \"type\",\n      \"text\": \"text content\",\n      \"bounds\": {\"x\": 0, \"y\": 0, \"width\": 100, \"height\": 30},\n      \"attributes\": {\"active\": true, \"collapsed\": false}\n    }\n  ],\n  \"layoutStructure\": {\n    \"type\": \"three-column|two-column|single-column\",\n    \"sidebarWidth\": 250,\n    \"editorArea\": {\"x\": 250, \"y\": 50, \"width\": 800, \"height\": 600},\n    \"panels\": [\"terminal\", \"output\"]\n  },\n  \"colorScheme\": \"dark|light\",\n  \"issues\": []\n}`;\n\n    const response = await this.callVLM(systemPrompt, userPrompt, screenshot, 'find');\n\n    try {\n      const parsed = this.parseJSON(response);\n      return {\n        elements: (parsed.elements as Array<{\n          elementType: string;\n          text?: string;\n          bounds: { x: number; y: number; width: number; height: number };\n          attributes?: Record<string, unknown>;\n        }>) || [],\n        layoutStructure: (parsed.layoutStructure as {\n          type: string;\n          sidebarWidth?: number;\n          editorArea?: { x: number; y: number; width: number; height: number };\n          panels?: string[];\n        }) || { type: 'unknown' },\n        colorScheme: ((parsed.colorScheme as string) === 'light' ? 'light' : 'dark'),\n        issues: (parsed.issues as string[]) || [],\n      };\n    } catch {\n      return {\n        elements: [],\n        layoutStructure: { type: 'unknown' },\n        colorScheme: 'dark',\n        issues: ['Failed to analyze screenshot'],\n      };\n    }\n  }\n\n  /**\n   * Get cost summary\n   */\n  getCostSummary(): CostSummary {\n    // Cursor mode is free (uses existing subscription)\n    if (this.cursorBridge) {\n      return this.cursorBridge.getCostSummary();\n    }\n    return this.costTracker.getSummary();\n  }\n\n  /**\n   * Reset cost tracking\n   */\n  resetCostTracking(): void {\n    this.costTracker.reset();\n  }\n\n  /**\n   * Call the VLM API\n   */\n  private async callVLM(\n    systemPrompt: string,\n    userPrompt: string,\n    screenshot: string,\n    operation: 'find' | 'action' | 'assert' | 'analyze'\n  ): Promise<string> {\n    let response: string;\n    let inputTokens = 0;\n    let outputTokens = 0;\n\n    switch (this.provider) {\n      case VLMProvider.ANTHROPIC:\n        ({ response, inputTokens, outputTokens } = await this.callAnthropic(systemPrompt, userPrompt, screenshot));\n        break;\n      case VLMProvider.OPENAI:\n        ({ response, inputTokens, outputTokens } = await this.callOpenAI(systemPrompt, userPrompt, screenshot));\n        break;\n      case VLMProvider.VOLCENGINE:\n      case VLMProvider.DOUBAO:\n        ({ response, inputTokens, outputTokens } = await this.callVolcengine(systemPrompt, userPrompt, screenshot));\n        break;\n      case VLMProvider.CUSTOM:\n        ({ response, inputTokens, outputTokens } = await this.callCustom(systemPrompt, userPrompt, screenshot));\n        break;\n      default:\n        throw new Error(`Unsupported VLM provider: ${this.provider}`);\n    }\n\n    // Track cost\n    if (this.config.trackCost !== false) {\n      this.costTracker.track({\n        provider: this.provider,\n        model: this.model,\n        inputTokens,\n        outputTokens,\n        images: 1,\n        operation,\n      });\n    }\n\n    return response;\n  }\n\n  /**\n   * Call Anthropic Claude API\n   */\n  private async callAnthropic(\n    systemPrompt: string,\n    userPrompt: string,\n    screenshot: string\n  ): Promise<{ response: string; inputTokens: number; outputTokens: number }> {\n    const apiKey = this.config.apiKey || process.env.ANTHROPIC_API_KEY;\n    if (!apiKey) {\n      throw new Error('Anthropic API key not provided. Set ANTHROPIC_API_KEY or pass apiKey in config.');\n    }\n\n    const fetchResponse = await fetch('https://api.anthropic.com/v1/messages', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'x-api-key': apiKey,\n        'anthropic-version': '2023-06-01',\n      },\n      body: JSON.stringify({\n        model: this.model,\n        max_tokens: this.config.maxTokens || 4096,\n        system: systemPrompt,\n        messages: [\n          {\n            role: 'user',\n            content: [\n              {\n                type: 'image',\n                source: {\n                  type: 'base64',\n                  media_type: 'image/jpeg',\n                  data: screenshot,\n                },\n              },\n              {\n                type: 'text',\n                text: userPrompt,\n              },\n            ],\n          },\n        ],\n      }),\n    });\n\n    if (!fetchResponse.ok) {\n      const error = await fetchResponse.text();\n      throw new Error(`Anthropic API error: ${error}`);\n    }\n\n    const data = await fetchResponse.json() as {\n      content: Array<{ text: string }>;\n      usage?: { input_tokens?: number; output_tokens?: number };\n    };\n    return {\n      response: data.content[0].text,\n      inputTokens: data.usage?.input_tokens || 1000,\n      outputTokens: data.usage?.output_tokens || 500,\n    };\n  }\n\n  /**\n   * Call OpenAI GPT-4V API\n   */\n  private async callOpenAI(\n    systemPrompt: string,\n    userPrompt: string,\n    screenshot: string\n  ): Promise<{ response: string; inputTokens: number; outputTokens: number }> {\n    const apiKey = this.config.apiKey || process.env.OPENAI_API_KEY;\n    if (!apiKey) {\n      throw new Error('OpenAI API key not provided. Set OPENAI_API_KEY or pass apiKey in config.');\n    }\n\n    const baseURL = this.config.baseURL || 'https://api.openai.com/v1';\n\n    const fetchResponse = await fetch(`${baseURL}/chat/completions`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${apiKey}`,\n      },\n      body: JSON.stringify({\n        model: this.model,\n        max_tokens: this.config.maxTokens || 4096,\n        messages: [\n          {\n            role: 'system',\n            content: systemPrompt,\n          },\n          {\n            role: 'user',\n            content: [\n              {\n                type: 'image_url',\n                image_url: {\n                  url: `data:image/jpeg;base64,${screenshot}`,\n                },\n              },\n              {\n                type: 'text',\n                text: userPrompt,\n              },\n            ],\n          },\n        ],\n      }),\n    });\n\n    if (!fetchResponse.ok) {\n      const error = await fetchResponse.text();\n      throw new Error(`OpenAI API error: ${error}`);\n    }\n\n    const data = await fetchResponse.json() as {\n      choices: Array<{ message: { content: string } }>;\n      usage?: { prompt_tokens?: number; completion_tokens?: number };\n    };\n    return {\n      response: data.choices[0].message.content,\n      inputTokens: data.usage?.prompt_tokens || 1000,\n      outputTokens: data.usage?.completion_tokens || 500,\n    };\n  }\n\n  /**\n   * Call Volcengine (Doubao) API\n   */\n  private async callVolcengine(\n    systemPrompt: string,\n    userPrompt: string,\n    screenshot: string\n  ): Promise<{ response: string; inputTokens: number; outputTokens: number }> {\n    const apiKey = this.config.apiKey || process.env.VOLCENGINE_API_KEY || process.env.DOUBAO_API_KEY;\n    if (!apiKey) {\n      throw new Error('Volcengine API key not provided. Set VOLCENGINE_API_KEY or pass apiKey in config.');\n    }\n\n    const baseURL = this.config.baseURL || 'https://ark.cn-beijing.volces.com/api/v3';\n\n    const fetchResponse = await fetch(`${baseURL}/chat/completions`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${apiKey}`,\n      },\n      body: JSON.stringify({\n        model: this.model,\n        max_tokens: this.config.maxTokens || 4096,\n        messages: [\n          {\n            role: 'system',\n            content: systemPrompt,\n          },\n          {\n            role: 'user',\n            content: [\n              {\n                type: 'image_url',\n                image_url: {\n                  url: `data:image/jpeg;base64,${screenshot}`,\n                },\n              },\n              {\n                type: 'text',\n                text: userPrompt,\n              },\n            ],\n          },\n        ],\n      }),\n    });\n\n    if (!fetchResponse.ok) {\n      const error = await fetchResponse.text();\n      throw new Error(`Volcengine API error: ${error}`);\n    }\n\n    const data = await fetchResponse.json() as {\n      choices: Array<{ message: { content: string } }>;\n      usage?: { prompt_tokens?: number; completion_tokens?: number };\n    };\n    return {\n      response: data.choices[0].message.content,\n      inputTokens: data.usage?.prompt_tokens || 1000,\n      outputTokens: data.usage?.completion_tokens || 500,\n    };\n  }\n\n  /**\n   * Call custom API (OpenAI-compatible)\n   */\n  private async callCustom(\n    systemPrompt: string,\n    userPrompt: string,\n    screenshot: string\n  ): Promise<{ response: string; inputTokens: number; outputTokens: number }> {\n    if (!this.config.baseURL) {\n      throw new Error('Custom provider requires baseURL');\n    }\n\n    const headers: Record<string, string> = {\n      'Content-Type': 'application/json',\n    };\n\n    if (this.config.apiKey) {\n      headers['Authorization'] = `Bearer ${this.config.apiKey}`;\n    }\n\n    const fetchResponse = await fetch(`${this.config.baseURL}/chat/completions`, {\n      method: 'POST',\n      headers,\n      body: JSON.stringify({\n        model: this.model,\n        max_tokens: this.config.maxTokens || 4096,\n        messages: [\n          {\n            role: 'system',\n            content: systemPrompt,\n          },\n          {\n            role: 'user',\n            content: [\n              {\n                type: 'image_url',\n                image_url: {\n                  url: `data:image/jpeg;base64,${screenshot}`,\n                },\n              },\n              {\n                type: 'text',\n                text: userPrompt,\n              },\n            ],\n          },\n        ],\n      }),\n    });\n\n    if (!fetchResponse.ok) {\n      const error = await fetchResponse.text();\n      throw new Error(`Custom API error: ${error}`);\n    }\n\n    const data = await fetchResponse.json() as {\n      choices: Array<{ message: { content: string } }>;\n      usage?: { prompt_tokens?: number; completion_tokens?: number };\n    };\n    return {\n      response: data.choices[0].message.content,\n      inputTokens: data.usage?.prompt_tokens || 1000,\n      outputTokens: data.usage?.completion_tokens || 500,\n    };\n  }\n\n  /**\n   * Parse JSON from VLM response (handles markdown code blocks)\n   */\n  private parseJSON(text: string): Record<string, unknown> {\n    // Try direct parse first\n    try {\n      return JSON.parse(text);\n    } catch {\n      // Try extracting from markdown code block\n      const jsonMatch = text.match(/```(?:json)?\\s*([\\s\\S]*?)```/);\n      if (jsonMatch) {\n        return JSON.parse(jsonMatch[1].trim());\n      }\n\n      // Try finding JSON object in text\n      const objectMatch = text.match(/\\{[\\s\\S]*\\}/);\n      if (objectMatch) {\n        return JSON.parse(objectMatch[0]);\n      }\n\n      throw new Error('Could not parse JSON from response');\n    }\n  }\n}\n","/**\n * @flowsight/desktop-test - Core DesktopTest Class\n *\n * The main entry point for the hybrid desktop testing framework.\n * Implements smart fallback chain: DOM  Accessibility  VLM\n */\n\nimport {\n  TestMode,\n  LocatorStrategy,\n  ActionStatus,\n  type DesktopTestConfig,\n  type SnapshotResult,\n  type ElementRef,\n  type ElementLocator,\n  type ClickOptions,\n  type TypeOptions,\n  type ScrollOptions,\n  type WaitOptions,\n  type ScreenshotOptions,\n  type ActionResult,\n  type BoundingBox,\n  type DesktopTestInstance,\n  type CostSummary,\n  type CDPAdapterInterface,\n  type PythonBridgeInterface,\n  type NutJSAdapterInterface,\n  type VLMClientInterface,\n} from '../types.js';\n\n/**\n * Default configuration values\n */\nconst DEFAULT_CONFIG: Required<DesktopTestConfig> = {\n  mode: TestMode.HYBRID,\n  cdp: { endpoint: 9222, timeout: 30000 },\n  vlm: undefined as unknown as Required<DesktopTestConfig>['vlm'],\n  pythonBridge: { debug: false },\n  nutjs: { keyboard: true, mouse: true, keyDelay: 50, mouseSpeed: 500 },\n  timeout: 30000,\n  debug: false,\n  screenshotDir: './screenshots',\n  videoDir: './videos',\n  session: 'default',\n};\n\n/**\n * Main Desktop Test class - implements the unified API with hybrid mode\n */\nexport class DesktopTest implements DesktopTestInstance {\n  private config: Required<DesktopTestConfig>;\n  private cdpAdapter: CDPAdapterInterface | null = null;\n  private pythonBridge: PythonBridgeInterface | null = null;\n  private nutjsAdapter: NutJSAdapterInterface | null = null;\n  private vlmClient: VLMClientInterface | null = null;\n  private connected: boolean = false;\n  private lastSnapshot: SnapshotResult | null = null;\n\n  constructor(config: DesktopTestConfig = {}) {\n    this.config = this.mergeConfig(config);\n  }\n\n  private mergeConfig(config: DesktopTestConfig): Required<DesktopTestConfig> {\n    return {\n      ...DEFAULT_CONFIG,\n      ...config,\n      cdp: { ...DEFAULT_CONFIG.cdp, ...config.cdp },\n      pythonBridge: { ...DEFAULT_CONFIG.pythonBridge, ...config.pythonBridge },\n      nutjs: { ...DEFAULT_CONFIG.nutjs, ...config.nutjs },\n    };\n  }\n\n  // ============================================================================\n  // Connection Management\n  // ============================================================================\n\n  async connect(): Promise<void> {\n    if (this.connected) return;\n\n    this.log('Connecting to desktop application...');\n\n    // Initialize CDP adapter for WebView control\n    if (this.config.cdp) {\n      const { CDPAdapter } = await import('../adapters/cdp-adapter.js');\n      this.cdpAdapter = new CDPAdapter(this.config.cdp);\n      await this.cdpAdapter.initialize();\n      await this.cdpAdapter.connect();\n      this.log('CDP adapter connected');\n    }\n\n    // Initialize Python bridge for native desktop control\n    if (this.config.pythonBridge) {\n      try {\n        const { PythonBridge } = await import('../adapters/python-bridge.js');\n        this.pythonBridge = new PythonBridge(this.config.pythonBridge);\n        await this.pythonBridge.initialize();\n        this.log('Python bridge initialized');\n      } catch (e) {\n        this.log('Python bridge not available, using NutJS fallback');\n      }\n    }\n\n    // Initialize NutJS adapter as fallback for native control\n    if (this.config.nutjs && !this.pythonBridge?.isAvailable()) {\n      try {\n        const { NutJSAdapter } = await import('../adapters/nutjs-adapter.js');\n        this.nutjsAdapter = new NutJSAdapter(this.config.nutjs);\n        await this.nutjsAdapter.initialize();\n        this.log('NutJS adapter initialized');\n      } catch (e) {\n        this.log('NutJS adapter not available');\n      }\n    }\n\n    // Initialize VLM client if in visual/hybrid mode\n    if (this.config.vlm && this.getMode() !== TestMode.DETERMINISTIC) {\n      const { VLMClient } = await import('../vlm/client.js');\n      this.vlmClient = new VLMClient(this.config.vlm);\n      this.log('VLM client initialized');\n    }\n\n    this.connected = true;\n    this.log('Connected successfully');\n  }\n\n  async disconnect(): Promise<void> {\n    if (!this.connected) return;\n\n    if (this.cdpAdapter) {\n      await this.cdpAdapter.cleanup();\n      this.cdpAdapter = null;\n    }\n\n    if (this.pythonBridge) {\n      await this.pythonBridge.cleanup();\n      this.pythonBridge = null;\n    }\n\n    if (this.nutjsAdapter) {\n      await this.nutjsAdapter.cleanup();\n      this.nutjsAdapter = null;\n    }\n\n    this.vlmClient = null;\n    this.connected = false;\n    this.log('Disconnected');\n  }\n\n  isConnected(): boolean {\n    return this.connected;\n  }\n\n  private getMode(): TestMode {\n    const mode = this.config.mode;\n    if (typeof mode === 'string') {\n      return mode as TestMode;\n    }\n    return mode;\n  }\n\n  // ============================================================================\n  // Snapshot\n  // ============================================================================\n\n  async snapshot(options: { interactive?: boolean } = {}): Promise<SnapshotResult> {\n    this.ensureConnected();\n\n    if (!this.cdpAdapter) {\n      throw new Error('CDP adapter not available for snapshot');\n    }\n\n    const result = await this.cdpAdapter.getSnapshot({\n      interactive: options.interactive ?? true,\n      includeScreenshot: this.getMode() !== TestMode.DETERMINISTIC,\n    });\n\n    this.lastSnapshot = result;\n    return result;\n  }\n\n  // ============================================================================\n  // Element Finding - Core Hybrid Mode Implementation\n  // ============================================================================\n\n  /**\n   * Find element using hybrid fallback chain:\n   * Level 1: Refs from snapshot (free, fast)\n   * Level 2: CSS/XPath via CDP (free, fast)\n   * Level 3: Visual AI via VLM (paid, intelligent)\n   */\n  async find(locator: string | ElementLocator): Promise<ElementRef | null> {\n    this.ensureConnected();\n\n    const normalized = this.normalizeLocator(locator);\n    const mode = this.getMode();\n\n    // Level 1 & 2: Try deterministic approach first (unless in VISUAL mode)\n    if (mode !== TestMode.VISUAL) {\n      const element = await this.findDeterministic(normalized);\n      if (element) {\n        this.log(`Found element via deterministic: ${normalized.value}`);\n        return element;\n      }\n    }\n\n    // Level 3: Fall back to VLM if in hybrid/visual mode\n    if (mode !== TestMode.DETERMINISTIC && this.vlmClient) {\n      this.log(`Falling back to VLM for: ${normalized.value}`);\n      return this.findVisual(normalized);\n    }\n\n    return null;\n  }\n\n  async findAll(locator: string | ElementLocator): Promise<ElementRef[]> {\n    this.ensureConnected();\n\n    if (!this.cdpAdapter) return [];\n\n    const normalized = this.normalizeLocator(locator);\n    return this.cdpAdapter.findAll(normalized);\n  }\n\n  async waitFor(locator: string | ElementLocator, options: WaitOptions = {}): Promise<ElementRef> {\n    const timeout = options.timeout || this.config.timeout;\n    const interval = options.interval || 100;\n    const startTime = Date.now();\n\n    while (Date.now() - startTime < timeout) {\n      const element = await this.find(locator);\n      if (element) {\n        if (options.state === 'hidden') {\n          await this.wait(interval);\n          continue;\n        }\n        return element;\n      }\n      await this.wait(interval);\n    }\n\n    throw new Error(`Element not found: ${JSON.stringify(locator)} (timeout: ${timeout}ms)`);\n  }\n\n  private async findDeterministic(locator: ElementLocator): Promise<ElementRef | null> {\n    // Level 1: Try refs from snapshot\n    if (locator.strategy === LocatorStrategy.REF) {\n      const element = await this.findByRef(locator.value);\n      if (element) return element;\n    }\n\n    // Level 2: Try CDP/DOM\n    if (this.cdpAdapter) {\n      return this.cdpAdapter.find(locator);\n    }\n\n    return null;\n  }\n\n  private async findByRef(ref: string): Promise<ElementRef | null> {\n    if (!this.lastSnapshot) {\n      await this.snapshot();\n    }\n\n    const cleanRef = ref.startsWith('@') ? ref.slice(1) : ref;\n    const element = this.lastSnapshot?.refs[cleanRef];\n\n    if (element) {\n      return { ...element, source: 'dom' };\n    }\n\n    return null;\n  }\n\n  private async findVisual(locator: ElementLocator): Promise<ElementRef | null> {\n    if (!this.vlmClient) return null;\n\n    // Get screenshot\n    const screenshot = await this.getScreenshotBase64();\n\n    // Ask VLM to find the element\n    const result = await this.vlmClient.findElement({\n      screenshot,\n      description: this.locatorToDescription(locator),\n    });\n\n    if (result.notFound || !result.coordinates) {\n      return null;\n    }\n\n    // Create a virtual ElementRef from VLM response\n    return {\n      id: 'vlm_' + Date.now(),\n      role: 'visual',\n      name: locator.value,\n      boundingBox: {\n        x: result.coordinates.x,\n        y: result.coordinates.y,\n        width: 1,\n        height: 1,\n      },\n      source: 'vlm',\n    };\n  }\n\n  // ============================================================================\n  // Actions\n  // ============================================================================\n\n  async click(locator: string | ElementLocator, options: ClickOptions = {}): Promise<ActionResult> {\n    const startTime = Date.now();\n    let usedVLM = false;\n\n    try {\n      const element = await this.find(locator);\n\n      if (!element) {\n        return {\n          status: ActionStatus.NOT_FOUND,\n          error: `Element not found: ${JSON.stringify(locator)}`,\n          duration: Date.now() - startTime,\n          usedVLM: false,\n        };\n      }\n\n      usedVLM = element.source === 'vlm';\n\n      // Use native adapter for precise clicking if we have coordinates\n      if (element.boundingBox && (this.pythonBridge?.isAvailable() || this.nutjsAdapter?.isAvailable())) {\n        const { x, y, width, height } = element.boundingBox;\n        const centerX = x + width / 2;\n        const centerY = y + height / 2;\n\n        if (this.pythonBridge?.isAvailable()) {\n          await this.pythonBridge.click(centerX, centerY, options.button || 'left');\n        } else if (this.nutjsAdapter?.isAvailable()) {\n          await this.nutjsAdapter.click(centerX, centerY, options.button || 'left', options.count || 1);\n        }\n      } else if (this.cdpAdapter) {\n        // Use CDP for WebView clicking\n        await this.cdpAdapter.click(element, options);\n      }\n\n      return {\n        status: usedVLM ? ActionStatus.VLM_FALLBACK : ActionStatus.SUCCESS,\n        duration: Date.now() - startTime,\n        usedVLM,\n        vlmCost: usedVLM ? this.vlmClient?.getCostSummary().totalCost : undefined,\n      };\n    } catch (error: unknown) {\n      const errorMessage = error instanceof Error ? error.message : String(error);\n      return {\n        status: ActionStatus.FAILED,\n        error: errorMessage,\n        duration: Date.now() - startTime,\n        usedVLM,\n      };\n    }\n  }\n\n  async dblclick(locator: string | ElementLocator): Promise<ActionResult> {\n    return this.click(locator, { count: 2 });\n  }\n\n  async rightClick(locator: string | ElementLocator): Promise<ActionResult> {\n    return this.click(locator, { button: 'right' });\n  }\n\n  async type(locator: string | ElementLocator, text: string, options: TypeOptions = {}): Promise<ActionResult> {\n    const startTime = Date.now();\n\n    try {\n      const element = await this.find(locator);\n      if (!element) {\n        return {\n          status: ActionStatus.NOT_FOUND,\n          error: `Element not found: ${JSON.stringify(locator)}`,\n          duration: Date.now() - startTime,\n          usedVLM: false,\n        };\n      }\n\n      // Click to focus first\n      await this.click(locator);\n\n      if (options.clear) {\n        await this.clear(locator);\n      }\n\n      // Type using appropriate adapter\n      if (this.pythonBridge?.isAvailable()) {\n        await this.pythonBridge.typeText(text);\n      } else if (this.nutjsAdapter?.isAvailable()) {\n        await this.nutjsAdapter.type(text, options.delay);\n      } else if (this.cdpAdapter) {\n        await this.cdpAdapter.type(element, text, options);\n      }\n\n      if (options.submit) {\n        await this.press('Enter');\n      }\n\n      return {\n        status: ActionStatus.SUCCESS,\n        duration: Date.now() - startTime,\n        usedVLM: element.source === 'vlm',\n      };\n    } catch (error: unknown) {\n      const errorMessage = error instanceof Error ? error.message : String(error);\n      return {\n        status: ActionStatus.FAILED,\n        error: errorMessage,\n        duration: Date.now() - startTime,\n        usedVLM: false,\n      };\n    }\n  }\n\n  async fill(locator: string | ElementLocator, text: string): Promise<ActionResult> {\n    return this.type(locator, text, { clear: true });\n  }\n\n  async clear(locator: string | ElementLocator): Promise<ActionResult> {\n    const startTime = Date.now();\n\n    try {\n      await this.click(locator);\n      await this.press('Control+a');\n      await this.press('Backspace');\n\n      return {\n        status: ActionStatus.SUCCESS,\n        duration: Date.now() - startTime,\n        usedVLM: false,\n      };\n    } catch (error: unknown) {\n      const errorMessage = error instanceof Error ? error.message : String(error);\n      return {\n        status: ActionStatus.FAILED,\n        error: errorMessage,\n        duration: Date.now() - startTime,\n        usedVLM: false,\n      };\n    }\n  }\n\n  async press(key: string): Promise<ActionResult> {\n    const startTime = Date.now();\n\n    try {\n      // Parse key combination (e.g., \"Control+a\", \"Meta+Shift+s\")\n      const parts = key.split('+');\n      const mainKey = parts[parts.length - 1];\n      const modifiers = parts.slice(0, -1);\n\n      if (this.pythonBridge?.isAvailable()) {\n        await this.pythonBridge.pressKey(mainKey, modifiers);\n      } else if (this.nutjsAdapter?.isAvailable()) {\n        await this.nutjsAdapter.press(key);\n      } else if (this.cdpAdapter) {\n        await this.cdpAdapter.press(key);\n      }\n\n      return {\n        status: ActionStatus.SUCCESS,\n        duration: Date.now() - startTime,\n        usedVLM: false,\n      };\n    } catch (error: unknown) {\n      const errorMessage = error instanceof Error ? error.message : String(error);\n      return {\n        status: ActionStatus.FAILED,\n        error: errorMessage,\n        duration: Date.now() - startTime,\n        usedVLM: false,\n      };\n    }\n  }\n\n  async hover(locator: string | ElementLocator): Promise<ActionResult> {\n    const startTime = Date.now();\n\n    try {\n      const element = await this.find(locator);\n      if (!element) {\n        return {\n          status: ActionStatus.NOT_FOUND,\n          error: `Element not found: ${JSON.stringify(locator)}`,\n          duration: Date.now() - startTime,\n          usedVLM: false,\n        };\n      }\n\n      if (element.boundingBox && (this.pythonBridge?.isAvailable() || this.nutjsAdapter?.isAvailable())) {\n        const { x, y, width, height } = element.boundingBox;\n        const centerX = x + width / 2;\n        const centerY = y + height / 2;\n\n        if (this.nutjsAdapter?.isAvailable()) {\n          await this.nutjsAdapter.moveTo(centerX, centerY);\n        }\n      } else if (this.cdpAdapter) {\n        await this.cdpAdapter.hover(element);\n      }\n\n      return {\n        status: ActionStatus.SUCCESS,\n        duration: Date.now() - startTime,\n        usedVLM: element.source === 'vlm',\n      };\n    } catch (error: unknown) {\n      const errorMessage = error instanceof Error ? error.message : String(error);\n      return {\n        status: ActionStatus.FAILED,\n        error: errorMessage,\n        duration: Date.now() - startTime,\n        usedVLM: false,\n      };\n    }\n  }\n\n  async scroll(options: ScrollOptions): Promise<ActionResult> {\n    const startTime = Date.now();\n\n    try {\n      const amount = options.amount || 100;\n\n      if (this.nutjsAdapter?.isAvailable()) {\n        await this.nutjsAdapter.scroll(options.direction, amount);\n      } else if (this.cdpAdapter) {\n        await this.cdpAdapter.scroll(options);\n      }\n\n      return {\n        status: ActionStatus.SUCCESS,\n        duration: Date.now() - startTime,\n        usedVLM: false,\n      };\n    } catch (error: unknown) {\n      const errorMessage = error instanceof Error ? error.message : String(error);\n      return {\n        status: ActionStatus.FAILED,\n        error: errorMessage,\n        duration: Date.now() - startTime,\n        usedVLM: false,\n      };\n    }\n  }\n\n  async drag(from: string | ElementLocator, to: string | ElementLocator): Promise<ActionResult> {\n    const startTime = Date.now();\n\n    try {\n      const fromElement = await this.find(from);\n      const toElement = await this.find(to);\n\n      if (!fromElement || !toElement) {\n        return {\n          status: ActionStatus.NOT_FOUND,\n          error: 'Source or target element not found',\n          duration: Date.now() - startTime,\n          usedVLM: false,\n        };\n      }\n\n      if (fromElement.boundingBox && toElement.boundingBox && this.nutjsAdapter?.isAvailable()) {\n        const fromBox = fromElement.boundingBox;\n        const toBox = toElement.boundingBox;\n        await this.nutjsAdapter.drag(\n          fromBox.x + fromBox.width / 2,\n          fromBox.y + fromBox.height / 2,\n          toBox.x + toBox.width / 2,\n          toBox.y + toBox.height / 2\n        );\n      } else if (this.cdpAdapter) {\n        await this.cdpAdapter.drag(fromElement, toElement);\n      }\n\n      return {\n        status: ActionStatus.SUCCESS,\n        duration: Date.now() - startTime,\n        usedVLM: false,\n      };\n    } catch (error: unknown) {\n      const errorMessage = error instanceof Error ? error.message : String(error);\n      return {\n        status: ActionStatus.FAILED,\n        error: errorMessage,\n        duration: Date.now() - startTime,\n        usedVLM: false,\n      };\n    }\n  }\n\n  // ============================================================================\n  // Visual AI Methods\n  // ============================================================================\n\n  async clickText(text: string): Promise<ActionResult> {\n    return this.click({ strategy: LocatorStrategy.VISUAL, value: `button or link with text \"${text}\"` });\n  }\n\n  async clickImage(description: string): Promise<ActionResult> {\n    return this.click({ strategy: LocatorStrategy.VISUAL, value: description });\n  }\n\n  async ai(instruction: string): Promise<ActionResult> {\n    const startTime = Date.now();\n\n    if (!this.vlmClient) {\n      return {\n        status: ActionStatus.FAILED,\n        error: 'VLM client not configured. Enable visual or hybrid mode.',\n        duration: Date.now() - startTime,\n        usedVLM: false,\n      };\n    }\n\n    try {\n      const actionSpaces = [\n        'click(x, y)',\n        'type(text)',\n        'scroll(direction)',\n        'press(key)',\n        'wait()',\n        'finished()',\n      ];\n\n      let maxIterations = 10;\n      let finished = false;\n\n      while (!finished && maxIterations > 0) {\n        const screenshot = await this.getScreenshotBase64();\n\n        const response = await this.vlmClient.getNextAction({\n          screenshot,\n          instruction,\n          actionSpaces,\n        });\n\n        if (response.finished) {\n          finished = true;\n          break;\n        }\n\n        // Execute the action\n        await this.executeVLMAction(response);\n        await this.wait(500);\n        maxIterations--;\n      }\n\n      return {\n        status: ActionStatus.SUCCESS,\n        duration: Date.now() - startTime,\n        usedVLM: true,\n        vlmCost: this.vlmClient.getCostSummary().totalCost,\n      };\n    } catch (error: unknown) {\n      const errorMessage = error instanceof Error ? error.message : String(error);\n      return {\n        status: ActionStatus.FAILED,\n        error: errorMessage,\n        duration: Date.now() - startTime,\n        usedVLM: true,\n      };\n    }\n  }\n\n  private async executeVLMAction(response: { actionType: string; actionParams: Record<string, unknown> }): Promise<void> {\n    switch (response.actionType) {\n      case 'click':\n        if (this.nutjsAdapter?.isAvailable() && response.actionParams.x && response.actionParams.y) {\n          await this.nutjsAdapter.click(\n            response.actionParams.x as number,\n            response.actionParams.y as number\n          );\n        }\n        break;\n      case 'type':\n        if (this.nutjsAdapter?.isAvailable() && response.actionParams.text) {\n          await this.nutjsAdapter.type(response.actionParams.text as string);\n        }\n        break;\n      case 'scroll':\n        await this.scroll({ direction: (response.actionParams.direction as ScrollOptions['direction']) || 'down' });\n        break;\n      case 'press':\n        await this.press((response.actionParams.key as string) || 'Enter');\n        break;\n      case 'wait':\n        await this.wait(2000);\n        break;\n    }\n  }\n\n  // ============================================================================\n  // Getters\n  // ============================================================================\n\n  async getText(locator: string | ElementLocator): Promise<string> {\n    this.ensureConnected();\n\n    if (!this.cdpAdapter) return '';\n\n    const element = await this.find(locator);\n    if (!element) return '';\n\n    return this.cdpAdapter.getText(element);\n  }\n\n  async getValue(locator: string | ElementLocator): Promise<string> {\n    this.ensureConnected();\n\n    if (!this.cdpAdapter) return '';\n\n    const element = await this.find(locator);\n    if (!element) return '';\n\n    return this.cdpAdapter.getValue(element);\n  }\n\n  async getAttribute(locator: string | ElementLocator, attr: string): Promise<string | null> {\n    this.ensureConnected();\n\n    if (!this.cdpAdapter) return null;\n\n    const element = await this.find(locator);\n    if (!element) return null;\n\n    return this.cdpAdapter.getAttribute(element, attr);\n  }\n\n  async isVisible(locator: string | ElementLocator): Promise<boolean> {\n    const element = await this.find(locator);\n    if (!element) return false;\n\n    if (this.cdpAdapter) {\n      return this.cdpAdapter.isVisible(element);\n    }\n\n    return true;\n  }\n\n  async isEnabled(locator: string | ElementLocator): Promise<boolean> {\n    const element = await this.find(locator);\n    if (!element) return false;\n\n    if (this.cdpAdapter) {\n      return this.cdpAdapter.isEnabled(element);\n    }\n\n    return true;\n  }\n\n  async count(locator: string | ElementLocator): Promise<number> {\n    const elements = await this.findAll(locator);\n    return elements.length;\n  }\n\n  async boundingBox(locator: string | ElementLocator): Promise<BoundingBox | null> {\n    const element = await this.find(locator);\n    return element?.boundingBox || null;\n  }\n\n  // ============================================================================\n  // Page\n  // ============================================================================\n\n  async getUrl(): Promise<string> {\n    this.ensureConnected();\n\n    if (!this.cdpAdapter) return '';\n\n    return this.cdpAdapter.getUrl();\n  }\n\n  async getTitle(): Promise<string> {\n    this.ensureConnected();\n\n    if (!this.cdpAdapter) return '';\n\n    return this.cdpAdapter.getTitle();\n  }\n\n  async evaluate<T>(script: string): Promise<T> {\n    this.ensureConnected();\n\n    if (!this.cdpAdapter) {\n      throw new Error('CDP adapter not available for evaluate');\n    }\n\n    return this.cdpAdapter.evaluate(script);\n  }\n\n  // ============================================================================\n  // Screenshot & Recording\n  // ============================================================================\n\n  async screenshot(path?: string, options: ScreenshotOptions = {}): Promise<string> {\n    this.ensureConnected();\n\n    if (!this.cdpAdapter) {\n      throw new Error('CDP adapter not available for screenshot');\n    }\n\n    return this.cdpAdapter.screenshot(path, options);\n  }\n\n  async startRecording(path: string): Promise<void> {\n    this.ensureConnected();\n\n    if (!this.cdpAdapter) {\n      throw new Error('CDP adapter not available for recording');\n    }\n\n    await this.cdpAdapter.startRecording(path);\n  }\n\n  async stopRecording(): Promise<{ path: string }> {\n    this.ensureConnected();\n\n    if (!this.cdpAdapter) {\n      throw new Error('CDP adapter not available for recording');\n    }\n\n    return this.cdpAdapter.stopRecording();\n  }\n\n  // ============================================================================\n  // Cost Tracking\n  // ============================================================================\n\n  getCostSummary(): CostSummary {\n    if (!this.vlmClient) {\n      return {\n        totalCost: 0,\n        totalCalls: 0,\n        byProvider: {},\n        byOperation: {},\n        entries: [],\n      };\n    }\n\n    return this.vlmClient.getCostSummary();\n  }\n\n  resetCostTracking(): void {\n    this.vlmClient?.resetCostTracking();\n  }\n\n  // ============================================================================\n  // Utilities\n  // ============================================================================\n\n  async wait(ms: number): Promise<void> {\n    return new Promise(resolve => setTimeout(resolve, ms));\n  }\n\n  async waitForIdle(timeout: number = 5000): Promise<void> {\n    this.ensureConnected();\n\n    if (this.cdpAdapter) {\n      await this.cdpAdapter.waitForIdle(timeout);\n    }\n  }\n\n  // ============================================================================\n  // Private Helpers\n  // ============================================================================\n\n  private ensureConnected(): void {\n    if (!this.connected) {\n      throw new Error('Not connected. Call connect() first.');\n    }\n  }\n\n  private normalizeLocator(locator: string | ElementLocator): ElementLocator {\n    if (typeof locator === 'string') {\n      // Parse string locator\n      if (locator.startsWith('@')) {\n        return { strategy: LocatorStrategy.REF, value: locator };\n      }\n      if (locator.startsWith('//')) {\n        return { strategy: LocatorStrategy.XPATH, value: locator };\n      }\n      if (locator.startsWith('text=')) {\n        return { strategy: LocatorStrategy.TEXT, value: locator.slice(5) };\n      }\n      if (locator.startsWith('role=')) {\n        return { strategy: LocatorStrategy.ROLE, value: locator.slice(5) };\n      }\n      if (locator.startsWith('[data-testid=')) {\n        return { strategy: LocatorStrategy.TESTID, value: locator };\n      }\n      // Default to CSS\n      return { strategy: LocatorStrategy.CSS, value: locator };\n    }\n    return locator;\n  }\n\n  private locatorToDescription(locator: ElementLocator): string {\n    switch (locator.strategy) {\n      case LocatorStrategy.TEXT:\n        return `element with text \"${locator.value}\"`;\n      case LocatorStrategy.ROLE:\n        return `${locator.value} element`;\n      case LocatorStrategy.VISUAL:\n        return locator.value;\n      default:\n        return `element matching ${locator.value}`;\n    }\n  }\n\n  private async getScreenshotBase64(): Promise<string> {\n    if (this.cdpAdapter) {\n      return this.cdpAdapter.getScreenshotBase64();\n    }\n    if (this.nutjsAdapter?.isAvailable()) {\n      return this.nutjsAdapter.screenshot();\n    }\n    if (this.pythonBridge?.isAvailable()) {\n      return this.pythonBridge.screenshot();\n    }\n    throw new Error('No adapter available for screenshot');\n  }\n\n  private log(message: string, ...args: unknown[]): void {\n    if (this.config.debug) {\n      console.log(`[desktop-test] ${message}`, ...args);\n    }\n  }\n}\n\n/**\n * Factory function for creating DesktopTest instance\n */\nexport function createDesktopTest(config: DesktopTestConfig = {}): DesktopTest {\n  return new DesktopTest(config);\n}\n","/**\n * @flowsight/desktop-test - Assertions\n *\n * Test assertion methods including data correctness checks.\n */\n\nimport {\n  type AssertionMethods,\n  type ElementLocator,\n  type DesktopTestInstance,\n} from '../types.js';\n\n/**\n * Assertion error with details\n */\nexport class AssertionError extends Error {\n  actual?: unknown;\n  expected?: unknown;\n\n  constructor(message: string, actual?: unknown, expected?: unknown) {\n    super(message);\n    this.name = 'AssertionError';\n    this.actual = actual;\n    this.expected = expected;\n  }\n}\n\n/**\n * Assertions class - implements test assertions\n */\nexport class Assertions implements AssertionMethods {\n  private test?: DesktopTestInstance;\n\n  constructor(test?: DesktopTestInstance) {\n    this.test = test;\n  }\n\n  // ============================================================================\n  // Static Value Assertions (no DesktopTest needed)\n  // ============================================================================\n\n  /**\n   * Assert a number is not zero (static version)\n   */\n  static valueNotZero(value: number, message?: string): void {\n    if (value === 0) {\n      throw new AssertionError(\n        message || `Expected non-zero value, got 0`,\n        value,\n        'non-zero'\n      );\n    }\n  }\n\n  /**\n   * Assert an array/string is not empty (static version)\n   */\n  static valueNotEmpty(value: unknown[] | string, message?: string): void {\n    if (value.length === 0) {\n      throw new AssertionError(\n        message || `Expected non-empty value, got empty`,\n        value,\n        'non-empty'\n      );\n    }\n  }\n\n  /**\n   * Assert data passes validation rules (static version)\n   */\n  static validateData<T extends Record<string, unknown>>(\n    data: T,\n    rules: { [K in keyof T]?: (value: T[K]) => boolean },\n    message?: string\n  ): void {\n    for (const [key, validator] of Object.entries(rules)) {\n      if (validator && !validator(data[key as keyof T] as T[keyof T])) {\n        throw new AssertionError(\n          message || `Validation failed for field \"${key}\"`,\n          data[key as keyof T],\n          `valid ${key}`\n        );\n      }\n    }\n  }\n\n  // ============================================================================\n  // Basic Assertions\n  // ============================================================================\n\n  ok(condition: boolean, message?: string): void {\n    if (!condition) {\n      throw new AssertionError(message || 'Expected condition to be truthy', condition, true);\n    }\n  }\n\n  equal<T>(actual: T, expected: T, message?: string): void {\n    if (actual !== expected) {\n      throw new AssertionError(\n        message || `Expected ${JSON.stringify(expected)}, got ${JSON.stringify(actual)}`,\n        actual,\n        expected\n      );\n    }\n  }\n\n  notEqual<T>(actual: T, expected: T, message?: string): void {\n    if (actual === expected) {\n      throw new AssertionError(\n        message || `Expected value to not equal ${JSON.stringify(expected)}`,\n        actual,\n        `not ${JSON.stringify(expected)}`\n      );\n    }\n  }\n\n  // ============================================================================\n  // Number Assertions\n  // ============================================================================\n\n  greaterThan(actual: number, expected: number, message?: string): void {\n    if (actual <= expected) {\n      throw new AssertionError(\n        message || `Expected ${actual} to be greater than ${expected}`,\n        actual,\n        `> ${expected}`\n      );\n    }\n  }\n\n  lessThan(actual: number, expected: number, message?: string): void {\n    if (actual >= expected) {\n      throw new AssertionError(\n        message || `Expected ${actual} to be less than ${expected}`,\n        actual,\n        `< ${expected}`\n      );\n    }\n  }\n\n  greaterOrEqual(actual: number, expected: number, message?: string): void {\n    if (actual < expected) {\n      throw new AssertionError(\n        message || `Expected ${actual} to be greater than or equal to ${expected}`,\n        actual,\n        `>= ${expected}`\n      );\n    }\n  }\n\n  lessOrEqual(actual: number, expected: number, message?: string): void {\n    if (actual > expected) {\n      throw new AssertionError(\n        message || `Expected ${actual} to be less than or equal to ${expected}`,\n        actual,\n        `<= ${expected}`\n      );\n    }\n  }\n\n  // ============================================================================\n  // String Assertions\n  // ============================================================================\n\n  contains(haystack: string, needle: string, message?: string): void {\n    if (!haystack.includes(needle)) {\n      throw new AssertionError(\n        message || `Expected \"${haystack.slice(0, 50)}...\" to contain \"${needle}\"`,\n        haystack,\n        `contains \"${needle}\"`\n      );\n    }\n  }\n\n  matches(actual: string, pattern: RegExp, message?: string): void {\n    if (!pattern.test(actual)) {\n      throw new AssertionError(\n        message || `Expected \"${actual.slice(0, 50)}...\" to match ${pattern}`,\n        actual,\n        pattern.toString()\n      );\n    }\n  }\n\n  // ============================================================================\n  // Element Assertions\n  // ============================================================================\n\n  private requireTest(): DesktopTestInstance {\n    if (!this.test) {\n      throw new Error('This assertion method requires a DesktopTest instance');\n    }\n    return this.test;\n  }\n\n  async exists(locator: string | ElementLocator, message?: string): Promise<void> {\n    const element = await this.requireTest().find(locator);\n    if (!element) {\n      throw new AssertionError(\n        message || `Expected element to exist: ${JSON.stringify(locator)}`,\n        null,\n        'element'\n      );\n    }\n  }\n\n  async notExists(locator: string | ElementLocator, message?: string): Promise<void> {\n    const element = await this.requireTest().find(locator);\n    if (element) {\n      throw new AssertionError(\n        message || `Expected element to not exist: ${JSON.stringify(locator)}`,\n        'element found',\n        null\n      );\n    }\n  }\n\n  async visible(locator: string | ElementLocator, message?: string): Promise<void> {\n    const isVisible = await this.requireTest().isVisible(locator);\n    if (!isVisible) {\n      throw new AssertionError(\n        message || `Expected element to be visible: ${JSON.stringify(locator)}`,\n        'not visible',\n        'visible'\n      );\n    }\n  }\n\n  async hidden(locator: string | ElementLocator, message?: string): Promise<void> {\n    const isVisible = await this.requireTest().isVisible(locator);\n    if (isVisible) {\n      throw new AssertionError(\n        message || `Expected element to be hidden: ${JSON.stringify(locator)}`,\n        'visible',\n        'hidden'\n      );\n    }\n  }\n\n  async hasText(locator: string | ElementLocator, text: string, message?: string): Promise<void> {\n    const actualText = await this.requireTest().getText(locator);\n    if (!actualText.includes(text)) {\n      throw new AssertionError(\n        message || `Expected element to have text \"${text}\", got \"${actualText.slice(0, 50)}...\"`,\n        actualText,\n        text\n      );\n    }\n  }\n\n  async hasValue(locator: string | ElementLocator, value: string, message?: string): Promise<void> {\n    const actualValue = await this.requireTest().getValue(locator);\n    if (actualValue !== value) {\n      throw new AssertionError(\n        message || `Expected element to have value \"${value}\", got \"${actualValue}\"`,\n        actualValue,\n        value\n      );\n    }\n  }\n\n  async hasAttribute(locator: string | ElementLocator, attr: string, value?: string, message?: string): Promise<void> {\n    const actualValue = await this.requireTest().getAttribute(locator, attr);\n    \n    if (actualValue === null) {\n      throw new AssertionError(\n        message || `Expected element to have attribute \"${attr}\"`,\n        null,\n        attr\n      );\n    }\n\n    if (value !== undefined && actualValue !== value) {\n      throw new AssertionError(\n        message || `Expected attribute \"${attr}\" to have value \"${value}\", got \"${actualValue}\"`,\n        actualValue,\n        value\n      );\n    }\n  }\n\n  // ============================================================================\n  // Data Correctness Assertions (Key feature for \"0 files\" bug prevention)\n  // ============================================================================\n\n  /**\n   * Assert that a numeric value from the element is not zero.\n   * This is specifically designed to catch the \"0 files, 0 functions\" bug.\n   */\n  async notZero(locator: string | ElementLocator, message?: string): Promise<void> {\n    const text = await this.requireTest().getText(locator);\n    \n    // Extract numbers from text\n    const numbers = text.match(/\\d+/g);\n    \n    if (!numbers || numbers.length === 0) {\n      throw new AssertionError(\n        message || `Expected element to contain a number: ${JSON.stringify(locator)}`,\n        text,\n        'number > 0'\n      );\n    }\n\n    const allZero = numbers.every(n => parseInt(n, 10) === 0);\n    if (allZero) {\n      throw new AssertionError(\n        message || `Expected non-zero value, but all numbers are zero: \"${text}\"`,\n        numbers,\n        'non-zero'\n      );\n    }\n  }\n\n  /**\n   * Assert that an element's text content is not empty.\n   */\n  async notEmpty(locator: string | ElementLocator, message?: string): Promise<void> {\n    const text = await this.requireTest().getText(locator);\n    const trimmed = text.trim();\n\n    if (trimmed.length === 0) {\n      throw new AssertionError(\n        message || `Expected element to have non-empty text: ${JSON.stringify(locator)}`,\n        '',\n        'non-empty text'\n      );\n    }\n  }\n\n  /**\n   * Assert that element data passes a custom validation function.\n   */\n  async dataCorrect(\n    locator: string | ElementLocator,\n    validator: (data: string) => boolean,\n    message?: string\n  ): Promise<void> {\n    const text = await this.requireTest().getText(locator);\n    \n    if (!validator(text)) {\n      throw new AssertionError(\n        message || `Data validation failed for: ${JSON.stringify(locator)}`,\n        text,\n        'valid data'\n      );\n    }\n  }\n\n  // ============================================================================\n  // Visual AI Assertions\n  // ============================================================================\n\n  /**\n   * Use VLM to visually verify a condition.\n   */\n  async visualCheck(description: string, _message?: string): Promise<void> {\n    // This would need VLM client access - simplified for now\n    // In full implementation, this would take a screenshot and ask VLM to verify\n    console.log(`  [Visual Check] ${description}`);\n    \n    // For now, just log - full implementation would use VLM\n    // const result = await this.vlmClient.assertVisual({\n    //   screenshot: await this.test.getScreenshotBase64(),\n    //   assertion: description,\n    // });\n    // if (!result.passed) {\n    //   throw new AssertionError(message || result.reasoning, result.actual, description);\n    // }\n  }\n\n  /**\n   * Compare current screenshot against baseline for visual regression.\n   */\n  async noVisualRegression(baseline: string, threshold: number = 0.95): Promise<void> {\n    // Simplified - would compare screenshots using image diff\n    console.log(`  [Visual Regression] Comparing against baseline: ${baseline} (threshold: ${threshold})`);\n    \n    // Full implementation would:\n    // 1. Load baseline image\n    // 2. Take current screenshot\n    // 3. Compare using pixel diff or perceptual hash\n    // 4. Fail if similarity < threshold\n  }\n}\n","/**\n * @flowsight/desktop-test - Test Runner\n *\n * Runs test cases and manages test lifecycle.\n */\n\nimport {\n  type TestCase,\n  type TestResult,\n  type TestSuiteResult,\n  type TestContext,\n  type DesktopTestConfig,\n  type Reporter,\n} from '../types.js';\n\nimport { DesktopTest } from './desktop-test.js';\nimport { Assertions } from './assertions.js';\n\n/**\n * Test runner options\n */\nexport interface TestRunnerOptions {\n  /** Desktop test configuration */\n  config?: DesktopTestConfig;\n  /** Stop on first failure */\n  stopOnFailure?: boolean;\n  /** Video recording directory */\n  videoDir?: string;\n  /** Reporter */\n  reporter?: Reporter;\n}\n\n/**\n * Logger implementation\n */\nclass Logger {\n  info(message: string, ...args: unknown[]): void {\n    console.log(`[INFO] ${message}`, ...args);\n  }\n\n  warn(message: string, ...args: unknown[]): void {\n    console.warn(`[WARN] ${message}`, ...args);\n  }\n\n  error(message: string, ...args: unknown[]): void {\n    console.error(`[ERROR] ${message}`, ...args);\n  }\n\n  debug(message: string, ...args: unknown[]): void {\n    console.debug(`[DEBUG] ${message}`, ...args);\n  }\n\n  step(message: string): void {\n    console.log(`   ${message}`);\n  }\n}\n\n/**\n * Test Runner - manages test execution\n */\nexport class TestRunner {\n  private options: TestRunnerOptions;\n  private desktopTest: DesktopTest;\n  private results: TestResult[] = [];\n  private logger = new Logger();\n\n  constructor(options: TestRunnerOptions = {}) {\n    this.options = {\n      stopOnFailure: false,\n      ...options,\n    };\n    this.desktopTest = new DesktopTest(options.config);\n  }\n\n  /**\n   * Run a single test case\n   */\n  async runTest(test: TestCase): Promise<TestResult> {\n    const startTime = Date.now();\n    const screenshots: string[] = [];\n    let passed = false;\n    let error: Error | undefined;\n    let usedVLM = false;\n\n    // Notify reporter\n    this.options.reporter?.onTestStart(test);\n\n    console.log(`\\n  [TEST] ${test.name}`);\n\n    // Start video recording if configured\n    let videoPath: string | undefined;\n    if (this.options.videoDir) {\n      const sanitizedName = test.name.replace(/[^a-zA-Z0-9]/g, '_');\n      videoPath = `${this.options.videoDir}/${sanitizedName}.webm`;\n      try {\n        await this.desktopTest.startRecording(videoPath);\n      } catch {\n        // Ignore recording start errors\n      }\n    }\n\n    // Create test context\n    const assertions = new Assertions(this.desktopTest);\n    const context: TestContext = {\n      test: this.desktopTest,\n      assert: assertions,\n      log: this.logger,\n    };\n\n    // Run test with retries\n    const maxRetries = test.retries || 0;\n    let attempts = 0;\n\n    while (attempts <= maxRetries) {\n      attempts++;\n      try {\n        await test.fn(context);\n        passed = true;\n        break;\n      } catch (e) {\n        error = e instanceof Error ? e : new Error(String(e));\n        if (attempts <= maxRetries) {\n          console.log(`    Retry ${attempts}/${maxRetries}...`);\n        }\n      }\n    }\n\n    // Stop video recording\n    if (videoPath) {\n      try {\n        await this.desktopTest.stopRecording();\n      } catch {\n        // Ignore recording stop errors\n      }\n    }\n\n    // Check VLM usage\n    const costSummary = this.desktopTest.getCostSummary();\n    usedVLM = costSummary.totalCalls > 0;\n\n    const result: TestResult = {\n      test,\n      passed,\n      error,\n      duration: Date.now() - startTime,\n      screenshots,\n      video: videoPath,\n      usedVLM,\n      vlmCost: costSummary.totalCost,\n    };\n\n    this.results.push(result);\n\n    // Print result\n    const status = passed ? ' PASS' : ' FAIL';\n    console.log(`  ${status} (${result.duration}ms)${usedVLM ? ` [VLM: $${costSummary.totalCost.toFixed(4)}]` : ''}`);\n    if (error) {\n      console.log(`    ${error.message}`);\n    }\n\n    // Notify reporter\n    this.options.reporter?.onTestEnd(result);\n\n    return result;\n  }\n\n  /**\n   * Run all test cases\n   */\n  async runAll(tests: TestCase[], suiteName: string = 'Desktop Tests'): Promise<TestSuiteResult> {\n    console.log('\\n');\n    console.log(`  ${suiteName}`);\n    console.log('\\n');\n\n    // Notify reporter\n    this.options.reporter?.onSuiteStart(suiteName);\n\n    // Connect to the application\n    console.log('  Connecting to application...');\n    try {\n      await this.desktopTest.connect();\n      console.log('   Connected\\n');\n    } catch (err) {\n      const message = err instanceof Error ? err.message : String(err);\n      console.log(`   Connection failed: ${message}`);\n      console.log('  Please ensure the Tauri app is running with remote debugging enabled.');\n      process.exit(1);\n    }\n\n    // Filter tests\n    const onlyTests = tests.filter(t => t.only);\n    const testsToRun = onlyTests.length > 0 ? onlyTests : tests.filter(t => !t.skip);\n\n    // Run tests\n    for (const test of testsToRun) {\n      const result = await this.runTest(test);\n\n      if (!result.passed && this.options.stopOnFailure) {\n        console.log('\\n  Stopping: stopOnFailure is enabled');\n        break;\n      }\n    }\n\n    // Disconnect\n    await this.desktopTest.disconnect();\n\n    // Build suite result\n    const suiteResult: TestSuiteResult = {\n      name: suiteName,\n      tests: this.results,\n      passed: this.results.filter(r => r.passed).length,\n      failed: this.results.filter(r => !r.passed).length,\n      skipped: tests.filter(t => t.skip).length,\n      duration: this.results.reduce((sum, r) => sum + r.duration, 0),\n      totalVLMCost: this.results.reduce((sum, r) => sum + (r.vlmCost || 0), 0),\n    };\n\n    // Print summary\n    this.printSummary(suiteResult);\n\n    // Notify reporter\n    this.options.reporter?.onSuiteEnd(suiteResult);\n\n    return suiteResult;\n  }\n\n  /**\n   * Print test summary\n   */\n  private printSummary(result: TestSuiteResult): void {\n    console.log('\\n');\n    console.log('  Test Results');\n    console.log('\\n');\n\n    console.log(`  Total:    ${result.tests.length} tests`);\n    console.log(`  Passed:   ${result.passed} `);\n    console.log(`  Failed:   ${result.failed} `);\n    console.log(`  Skipped:  ${result.skipped}`);\n    console.log(`  Duration: ${result.duration}ms`);\n\n    if (result.totalVLMCost > 0) {\n      console.log(`  VLM Cost: $${result.totalVLMCost.toFixed(4)}`);\n    }\n\n    if (result.failed > 0) {\n      console.log('\\n  Failed tests:');\n      for (const test of result.tests.filter(t => !t.passed)) {\n        console.log(`    - ${test.test.name}`);\n        if (test.error) {\n          console.log(`      ${test.error.message}`);\n        }\n      }\n    }\n\n    console.log('\\n\\n');\n\n    // Set exit code\n    if (result.failed > 0) {\n      process.exitCode = 1;\n    }\n  }\n\n  /**\n   * Get test results\n   */\n  getResults(): TestResult[] {\n    return this.results;\n  }\n\n  /**\n   * Reset results\n   */\n  reset(): void {\n    this.results = [];\n    this.desktopTest.resetCostTracking();\n  }\n}\n","/**\n * @flowsight/desktop-test\n *\n * A powerful, hybrid desktop automation testing suite for Tauri/Electron applications.\n * Combines deterministic DOM testing with VLM-powered visual AI fallback.\n *\n * Features:\n * - Hybrid Mode: Deterministic first, VLM fallback when needed\n * - Multi-Provider VLM: Anthropic Claude, OpenAI GPT-4V, Volcengine Doubao\n * - Cost Tracking: Monitor and control VLM API costs\n * - Cross-Platform: macOS, Linux, Windows via Python bridge\n * - Tauri Native: First-class support for Tauri WebView testing\n *\n * @example\n * ```typescript\n * import { DesktopTest, TestMode } from '@flowsight/desktop-test';\n *\n * const test = new DesktopTest({\n *   mode: TestMode.HYBRID,\n *   cdp: { endpoint: 9222 },\n *   vlm: {\n *     provider: 'anthropic',\n *     model: 'claude-sonnet-4-20250514',\n *   },\n * });\n *\n * await test.connect();\n * await test.click('@e2');  // Deterministic (refs)\n * await test.clickText('Submit');  // Visual AI fallback\n * await test.ai('Fill the login form');  // Full AI control\n *\n * console.log(test.getCostSummary());  // Track VLM costs\n * ```\n */\n\n// Core\nexport { DesktopTest, createDesktopTest } from './core/desktop-test.js';\nexport { TestRunner } from './core/test-runner.js';\nexport { Assertions } from './core/assertions.js';\n\n// Types - Enums\nexport {\n  TestMode,\n  LocatorStrategy,\n  ActionStatus,\n  VLMProvider,\n  Platform,\n} from './types.js';\n\n// Types - Configurations\nexport type {\n  DesktopTestConfig,\n  VLMConfig,\n  CDPConfig,\n  PythonBridgeConfig,\n  NutJSConfig,\n} from './types.js';\n\n// Types - Elements\nexport type {\n  SnapshotResult,\n  ElementRef,\n  ElementLocator,\n  BoundingBox,\n} from './types.js';\n\n// Types - Actions\nexport type {\n  ClickOptions,\n  TypeOptions,\n  ScrollOptions,\n  WaitOptions,\n  ScreenshotOptions,\n  ActionResult,\n} from './types.js';\n\n// Types - VLM\nexport type {\n  VLMFindRequest,\n  VLMFindResponse,\n  VLMActionRequest,\n  VLMActionResponse,\n  VLMAssertRequest,\n  VLMAssertResponse,\n  CostEntry,\n  CostSummary,\n} from './types.js';\n\n// Types - Testing\nexport type {\n  TestCase,\n  TestFunction,\n  TestContext,\n  TestResult,\n  TestSuiteResult,\n  DesktopTestInstance,\n  AssertionMethods,\n  LogMethods,\n  Reporter,\n} from './types.js';\n\n// Types - Adapters\nexport type {\n  Adapter,\n  CDPAdapterInterface,\n  PythonBridgeInterface,\n  NutJSAdapterInterface,\n  VLMClientInterface,\n} from './types.js';\n\n// VLM\nexport { VLMClient } from './vlm/client.js';\nexport { CostTracker } from './vlm/cost-tracker.js';\n\n// Adapters\nexport { CDPAdapter } from './adapters/cdp-adapter.js';\nexport { PythonBridge } from './adapters/python-bridge.js';\nexport { NutJSAdapter } from './adapters/nutjs-adapter.js';\n\n// Convenience alias\nexport { TestMode as HybridMode } from './types.js';\n"]}