{"version":3,"sources":["../../src/adapters/cdp-adapter.ts","../../src/adapters/python-bridge.ts","../../src/adapters/nutjs-adapter.ts"],"names":["resolve"],"mappings":"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","file":"index.js","sourcesContent":["/**\n * @flowsight/desktop-test - CDP Adapter\n *\n * Chrome DevTools Protocol adapter for WebView/Browser control.\n * Uses agent-browser CLI under the hood for Tauri/Electron app testing.\n */\n\nimport { execSync } from 'child_process';\nimport * as fs from 'fs';\n\nimport {\n  LocatorStrategy,\n  type CDPConfig,\n  type SnapshotResult,\n  type ElementRef,\n  type ElementLocator,\n  type ClickOptions,\n  type TypeOptions,\n  type ScrollOptions,\n  type ScreenshotOptions,\n  type CDPAdapterInterface,\n} from '../types.js';\n\n/**\n * CDP Adapter - controls WebView through Chrome DevTools Protocol\n */\nexport class CDPAdapter implements CDPAdapterInterface {\n  private config: Required<CDPConfig>;\n  private connected: boolean = false;\n  private refMap: Map<string, ElementRef> = new Map();\n  private refCounter: number = 0;\n  private session: string;\n\n  constructor(config: CDPConfig) {\n    this.config = {\n      endpoint: config.endpoint,\n      timeout: config.timeout || 30000,\n    };\n    this.session = `session_${Date.now()}`;\n  }\n\n  /**\n   * Initialize adapter\n   */\n  async initialize(): Promise<void> {\n    // Check if agent-browser is available\n    try {\n      execSync('agent-browser --version', { encoding: 'utf-8', stdio: 'pipe' });\n    } catch {\n      console.warn('[CDP Adapter] agent-browser not found. Install with: npm install -g agent-browser');\n    }\n  }\n\n  /**\n   * Cleanup adapter\n   */\n  async cleanup(): Promise<void> {\n    await this.disconnect();\n  }\n\n  /**\n   * Check if available\n   */\n  isAvailable(): boolean {\n    try {\n      execSync('agent-browser --version', { encoding: 'utf-8', stdio: 'pipe' });\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * Connect to the browser/app via CDP\n   */\n  async connect(): Promise<void> {\n    const endpoint = typeof this.config.endpoint === 'number'\n      ? String(this.config.endpoint)\n      : this.config.endpoint;\n\n    try {\n      this.exec(['open', `--cdp=${endpoint}`]);\n      this.connected = true;\n    } catch (error: unknown) {\n      const message = error instanceof Error ? error.message : String(error);\n      throw new Error(`Failed to connect via CDP: ${message}`);\n    }\n  }\n\n  /**\n   * Disconnect from the browser/app\n   */\n  async disconnect(): Promise<void> {\n    if (!this.connected) return;\n\n    try {\n      this.exec(['close']);\n    } catch {\n      // Ignore close errors\n    }\n\n    this.connected = false;\n  }\n\n  /**\n   * Get accessibility snapshot with refs\n   */\n  async getSnapshot(options: { interactive?: boolean; includeScreenshot?: boolean } = {}): Promise<SnapshotResult> {\n    this.ensureConnected();\n\n    const args = ['snapshot'];\n    if (options.interactive) args.push('-i');\n\n    const result = this.execJson<{ snapshot: string; refs?: Record<string, { role: string; name?: string }> }>(args);\n\n    // Convert refs to our format\n    const refs: Record<string, ElementRef> = {};\n    if (result.refs) {\n      for (const [key, value] of Object.entries(result.refs)) {\n        refs[key] = {\n          id: key,\n          role: value.role,\n          name: value.name,\n          source: 'dom',\n        };\n        this.refMap.set(key, refs[key]);\n      }\n    }\n\n    let screenshot: string | undefined;\n    if (options.includeScreenshot) {\n      screenshot = await this.getScreenshotBase64();\n    }\n\n    return {\n      tree: result.snapshot || '',\n      refs,\n      timestamp: Date.now(),\n      screenshot,\n    };\n  }\n\n  /**\n   * Find single element\n   */\n  async find(locator: ElementLocator): Promise<ElementRef | null> {\n    this.ensureConnected();\n\n    try {\n      const selector = this.locatorToSelector(locator);\n      const result = this.execJson<{ visible: boolean }>(['is', 'visible', selector]);\n\n      if (result.visible) {\n        const refId = `cdp_${++this.refCounter}`;\n        return {\n          id: refId,\n          role: 'element',\n          name: locator.value,\n          source: 'dom',\n        };\n      }\n    } catch {\n      // Element not found\n    }\n\n    return null;\n  }\n\n  /**\n   * Find all matching elements\n   */\n  async findAll(locator: ElementLocator): Promise<ElementRef[]> {\n    this.ensureConnected();\n\n    try {\n      const selector = this.locatorToSelector(locator);\n      const result = this.execJson<{ count: number }>(['get', 'count', selector]);\n\n      const count = result.count || 0;\n      return Array.from({ length: count }, (_, i) => ({\n        id: `cdp_${++this.refCounter}`,\n        role: 'element',\n        name: locator.value,\n        nth: i,\n        source: 'dom' as const,\n      }));\n    } catch {\n      return [];\n    }\n  }\n\n  /**\n   * Click element\n   */\n  async click(element: ElementRef, options: ClickOptions = {}): Promise<void> {\n    this.ensureConnected();\n\n    const selector = this.elementToSelector(element);\n    const args = ['click', selector];\n\n    if (options.count && options.count > 1) {\n      // For double-click\n      this.exec(['dblclick', selector]);\n    } else {\n      this.exec(args);\n    }\n  }\n\n  /**\n   * Type text\n   */\n  async type(element: ElementRef, text: string, _options: TypeOptions = {}): Promise<void> {\n    this.ensureConnected();\n\n    const selector = this.elementToSelector(element);\n    const escapedText = text.replace(/\"/g, '\\\\\"');\n    this.exec(['type', selector, `\"${escapedText}\"`]);\n  }\n\n  /**\n   * Press key\n   */\n  async press(key: string): Promise<void> {\n    this.ensureConnected();\n    this.exec(['press', key]);\n  }\n\n  /**\n   * Hover over element\n   */\n  async hover(element: ElementRef): Promise<void> {\n    this.ensureConnected();\n\n    const selector = this.elementToSelector(element);\n    this.exec(['hover', selector]);\n  }\n\n  /**\n   * Scroll\n   */\n  async scroll(options: ScrollOptions): Promise<void> {\n    this.ensureConnected();\n\n    const amount = options.amount || 100;\n    this.exec(['scroll', options.direction, String(amount)]);\n  }\n\n  /**\n   * Drag element\n   */\n  async drag(from: ElementRef, to: ElementRef): Promise<void> {\n    this.ensureConnected();\n\n    const fromSelector = this.elementToSelector(from);\n    const toSelector = this.elementToSelector(to);\n    this.exec(['drag', fromSelector, toSelector]);\n  }\n\n  /**\n   * Get element text\n   */\n  async getText(element: ElementRef): Promise<string> {\n    this.ensureConnected();\n\n    const selector = this.elementToSelector(element);\n    const result = this.execJson<{ text: string }>(['get', 'text', selector]);\n    return result.text || '';\n  }\n\n  /**\n   * Get element value\n   */\n  async getValue(element: ElementRef): Promise<string> {\n    this.ensureConnected();\n\n    const selector = this.elementToSelector(element);\n    const result = this.execJson<{ value: string }>(['get', 'value', selector]);\n    return result.value || '';\n  }\n\n  /**\n   * Get element attribute\n   */\n  async getAttribute(element: ElementRef, attr: string): Promise<string | null> {\n    this.ensureConnected();\n\n    const selector = this.elementToSelector(element);\n    const result = this.execJson<{ value: string | null }>(['get', 'attr', selector, attr]);\n    return result.value;\n  }\n\n  /**\n   * Check if element is visible\n   */\n  async isVisible(element: ElementRef): Promise<boolean> {\n    this.ensureConnected();\n\n    try {\n      const selector = this.elementToSelector(element);\n      const result = this.execJson<{ visible: boolean }>(['is', 'visible', selector]);\n      return result.visible;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * Check if element is enabled\n   */\n  async isEnabled(element: ElementRef): Promise<boolean> {\n    this.ensureConnected();\n\n    try {\n      const selector = this.elementToSelector(element);\n      const result = this.execJson<{ enabled: boolean }>(['is', 'enabled', selector]);\n      return result.enabled;\n    } catch {\n      return false;\n    }\n  }\n\n  /**\n   * Get current URL\n   */\n  async getUrl(): Promise<string> {\n    this.ensureConnected();\n\n    const result = this.execJson<{ url: string }>(['get', 'url']);\n    return result.url || '';\n  }\n\n  /**\n   * Get page title\n   */\n  async getTitle(): Promise<string> {\n    this.ensureConnected();\n\n    const result = this.execJson<{ title: string }>(['get', 'title']);\n    return result.title || '';\n  }\n\n  /**\n   * Evaluate JavaScript\n   */\n  async evaluate<T>(script: string): Promise<T> {\n    this.ensureConnected();\n\n    const escapedScript = script.replace(/\"/g, '\\\\\"');\n    const result = this.execJson<{ result: T }>(['eval', `\"${escapedScript}\"`]);\n    return result.result;\n  }\n\n  /**\n   * Take screenshot\n   */\n  async screenshot(screenshotPath?: string, options: ScreenshotOptions = {}): Promise<string> {\n    this.ensureConnected();\n\n    const args = ['screenshot'];\n    if (screenshotPath) args.push(screenshotPath);\n    if (options.fullPage) args.push('--full');\n\n    const result = this.execJson<{ path: string }>(args);\n    return result.path;\n  }\n\n  /**\n   * Get screenshot as base64\n   */\n  async getScreenshotBase64(): Promise<string> {\n    const tempPath = `/tmp/desktop-test-screenshot-${Date.now()}.jpg`;\n\n    try {\n      this.exec(['screenshot', tempPath]);\n      const data = fs.readFileSync(tempPath);\n      return data.toString('base64');\n    } finally {\n      if (fs.existsSync(tempPath)) {\n        fs.unlinkSync(tempPath);\n      }\n    }\n  }\n\n  /**\n   * Start recording\n   */\n  async startRecording(recordingPath: string): Promise<void> {\n    this.ensureConnected();\n    this.exec(['record', 'start', recordingPath]);\n  }\n\n  /**\n   * Stop recording\n   */\n  async stopRecording(): Promise<{ path: string }> {\n    this.ensureConnected();\n\n    const result = this.execJson<{ path: string }>(['record', 'stop']);\n    return { path: result.path || '' };\n  }\n\n  /**\n   * Wait for page to be idle\n   */\n  async waitForIdle(timeout: number = 5000): Promise<void> {\n    this.ensureConnected();\n    this.exec(['wait', '--load', 'networkidle'], { timeout });\n  }\n\n  // ============================================================================\n  // Private Helpers\n  // ============================================================================\n\n  private ensureConnected(): void {\n    if (!this.connected) {\n      throw new Error('CDP adapter not connected');\n    }\n  }\n\n  private exec(args: string[], options: { timeout?: number } = {}): string {\n    const sessionArg = `--session=${this.session}`;\n    const cmd = `agent-browser ${sessionArg} ${args.join(' ')}`.trim();\n\n    try {\n      return execSync(cmd, {\n        encoding: 'utf-8',\n        timeout: options.timeout ?? this.config.timeout,\n        stdio: ['pipe', 'pipe', 'pipe'],\n      }).trim();\n    } catch (err: unknown) {\n      const error = err as { stderr?: Buffer; stdout?: Buffer; message?: string };\n      const stderr = error.stderr?.toString() || '';\n      const stdout = error.stdout?.toString() || '';\n      throw new Error(`agent-browser command failed: ${cmd}\\nstderr: ${stderr}\\nstdout: ${stdout}`);\n    }\n  }\n\n  private execJson<T>(args: string[]): T {\n    const result = this.exec([...args, '--json']);\n\n    try {\n      const parsed = JSON.parse(result);\n      if (!parsed.success && parsed.error) {\n        throw new Error(parsed.error);\n      }\n      return (parsed.data || parsed) as T;\n    } catch (err: unknown) {\n      if (err instanceof Error && err.message.includes('agent-browser')) {\n        throw err;\n      }\n      throw new Error(`JSON parse failed: ${result}`);\n    }\n  }\n\n  private locatorToSelector(locator: ElementLocator): string {\n    switch (locator.strategy) {\n      case LocatorStrategy.REF:\n        return locator.value.startsWith('@') ? locator.value : `@${locator.value}`;\n      case LocatorStrategy.CSS:\n        return locator.value;\n      case LocatorStrategy.XPATH:\n        return `xpath=${locator.value}`;\n      case LocatorStrategy.TEXT:\n        return `text=${locator.value}`;\n      case LocatorStrategy.ROLE:\n        return `role=${locator.value}`;\n      case LocatorStrategy.TESTID:\n        return locator.value;\n      default:\n        return locator.value;\n    }\n  }\n\n  private elementToSelector(element: ElementRef): string {\n    if (element.id.startsWith('cdp_')) {\n      return element.name || '';\n    }\n    return `@${element.id}`;\n  }\n}\n","/**\n * @flowsight/desktop-test - Python Bridge Adapter\n *\n * Bridge to the existing Python desktop automation framework.\n * Communicates with Python via subprocess and JSON-RPC style messages.\n */\n\nimport { spawn, ChildProcess } from 'child_process';\nimport * as path from 'path';\nimport * as readline from 'readline';\n\nimport {\n  type PythonBridgeConfig,\n  type PythonBridgeInterface,\n} from '../types.js';\n\n/**\n * Default Python bridge configuration\n */\nconst DEFAULT_CONFIG: Required<PythonBridgeConfig> = {\n  pythonPath: 'python3',\n  serverPath: '',\n  port: 0,\n  debug: false,\n};\n\n/**\n * Python Bridge - connects to the existing Python desktop automation framework\n */\nexport class PythonBridge implements PythonBridgeInterface {\n  private config: Required<PythonBridgeConfig>;\n  private process: ChildProcess | null = null;\n  private available: boolean = false;\n  private requestId: number = 0;\n  private pendingRequests: Map<number, {\n    resolve: (value: unknown) => void;\n    reject: (error: Error) => void;\n  }> = new Map();\n  private readline: readline.Interface | null = null;\n\n  constructor(config: PythonBridgeConfig = {}) {\n    this.config = { ...DEFAULT_CONFIG, ...config };\n\n    // Default server path relative to this package\n    if (!this.config.serverPath) {\n      // Look for bridge server in the app/tests/desktop directory\n      this.config.serverPath = path.resolve(\n        __dirname,\n        '../../../../app/tests/desktop/bridge_server.py'\n      );\n    }\n  }\n\n  /**\n   * Initialize the Python bridge\n   */\n  async initialize(): Promise<void> {\n    try {\n      // Spawn Python subprocess\n      this.process = spawn(this.config.pythonPath, [this.config.serverPath], {\n        stdio: ['pipe', 'pipe', 'pipe'],\n        env: {\n          ...process.env,\n          PYTHONUNBUFFERED: '1',\n        },\n      });\n\n      if (!this.process.stdout || !this.process.stdin) {\n        throw new Error('Failed to create Python process streams');\n      }\n\n      // Set up readline for stdout\n      this.readline = readline.createInterface({\n        input: this.process.stdout,\n        terminal: false,\n      });\n\n      // Handle responses\n      this.readline.on('line', (line) => {\n        this.handleResponse(line);\n      });\n\n      // Handle stderr for debugging\n      this.process.stderr?.on('data', (data) => {\n        if (this.config.debug) {\n          console.error(`[Python Bridge stderr] ${data.toString()}`);\n        }\n      });\n\n      // Handle process exit\n      this.process.on('exit', (code) => {\n        this.available = false;\n        if (this.config.debug) {\n          console.log(`[Python Bridge] Process exited with code ${code}`);\n        }\n      });\n\n      // Wait for ready signal\n      await this.waitForReady();\n      this.available = true;\n\n      if (this.config.debug) {\n        console.log('[Python Bridge] Initialized successfully');\n      }\n    } catch (error) {\n      this.available = false;\n      throw error;\n    }\n  }\n\n  /**\n   * Cleanup the Python bridge\n   */\n  async cleanup(): Promise<void> {\n    if (this.process) {\n      try {\n        await this.call('shutdown');\n      } catch {\n        // Ignore shutdown errors\n      }\n\n      this.process.kill();\n      this.process = null;\n    }\n\n    if (this.readline) {\n      this.readline.close();\n      this.readline = null;\n    }\n\n    this.available = false;\n    this.pendingRequests.clear();\n  }\n\n  /**\n   * Check if available\n   */\n  isAvailable(): boolean {\n    return this.available && this.process !== null;\n  }\n\n  /**\n   * Call a Python method\n   */\n  async call<T>(method: string, args: unknown[] = []): Promise<T> {\n    if (!this.isAvailable()) {\n      throw new Error('Python bridge not available');\n    }\n\n    const id = ++this.requestId;\n    const request = {\n      jsonrpc: '2.0',\n      id,\n      method,\n      params: args,\n    };\n\n    return new Promise((resolve, reject) => {\n      this.pendingRequests.set(id, { resolve: resolve as (v: unknown) => void, reject });\n\n      // Send request\n      this.process!.stdin!.write(JSON.stringify(request) + '\\n');\n\n      // Timeout\n      setTimeout(() => {\n        if (this.pendingRequests.has(id)) {\n          this.pendingRequests.delete(id);\n          reject(new Error(`Python bridge timeout for method: ${method}`));\n        }\n      }, 30000);\n    });\n  }\n\n  /**\n   * Take screenshot via Python\n   */\n  async screenshot(): Promise<string> {\n    return this.call<string>('screenshot');\n  }\n\n  /**\n   * Click at coordinates via Python\n   */\n  async click(x: number, y: number, button: string = 'left'): Promise<void> {\n    await this.call('click', [x, y, button]);\n  }\n\n  /**\n   * Type text via Python\n   */\n  async typeText(text: string): Promise<void> {\n    await this.call('type_text', [text]);\n  }\n\n  /**\n   * Press key via Python\n   */\n  async pressKey(key: string, modifiers: string[] = []): Promise<void> {\n    await this.call('press_key', [key, modifiers]);\n  }\n\n  /**\n   * Get accessibility tree via Python\n   */\n  async getAccessibilityTree(): Promise<unknown> {\n    return this.call('get_accessibility_tree');\n  }\n\n  /**\n   * Analyze screenshot with VLM via Python\n   */\n  async analyzeVisual(screenshotBase64: string): Promise<unknown> {\n    return this.call('analyze_visual', [screenshotBase64]);\n  }\n\n  // ============================================================================\n  // Additional Desktop Control Methods\n  // ============================================================================\n\n  /**\n   * Move mouse to coordinates\n   */\n  async moveMouse(x: number, y: number): Promise<void> {\n    await this.call('move_mouse', [x, y]);\n  }\n\n  /**\n   * Double click\n   */\n  async doubleClick(x: number, y: number): Promise<void> {\n    await this.call('double_click', [x, y]);\n  }\n\n  /**\n   * Right click\n   */\n  async rightClick(x: number, y: number): Promise<void> {\n    await this.call('click', [x, y, 'right']);\n  }\n\n  /**\n   * Drag from one point to another\n   */\n  async drag(fromX: number, fromY: number, toX: number, toY: number): Promise<void> {\n    await this.call('drag', [fromX, fromY, toX, toY]);\n  }\n\n  /**\n   * Scroll\n   */\n  async scroll(x: number, y: number, deltaX: number, deltaY: number): Promise<void> {\n    await this.call('scroll', [x, y, deltaX, deltaY]);\n  }\n\n  /**\n   * Find application window\n   */\n  async findApplication(appName: string): Promise<unknown> {\n    return this.call('find_application', [appName]);\n  }\n\n  /**\n   * Activate application window\n   */\n  async activateApplication(appName: string): Promise<void> {\n    await this.call('activate_application', [appName]);\n  }\n\n  /**\n   * Get screen size\n   */\n  async getScreenSize(): Promise<{ width: number; height: number }> {\n    return this.call('get_screen_size');\n  }\n\n  /**\n   * Find element by name\n   */\n  async findElementByName(name: string, elementType?: string): Promise<unknown> {\n    return this.call('find_element_by_name', [name, elementType]);\n  }\n\n  // ============================================================================\n  // Private Methods\n  // ============================================================================\n\n  /**\n   * Wait for Python process to be ready\n   */\n  private async waitForReady(): Promise<void> {\n    return new Promise((resolve, reject) => {\n      const timeout = setTimeout(() => {\n        reject(new Error('Python bridge startup timeout'));\n      }, 10000);\n\n      const handler = (line: string) => {\n        try {\n          const data = JSON.parse(line);\n          if (data.status === 'ready') {\n            clearTimeout(timeout);\n            this.readline?.off('line', handler);\n            resolve();\n          }\n        } catch {\n          // Ignore non-JSON lines during startup\n        }\n      };\n\n      this.readline?.on('line', handler);\n    });\n  }\n\n  /**\n   * Handle response from Python process\n   */\n  private handleResponse(line: string): void {\n    try {\n      const response = JSON.parse(line);\n\n      // Skip status messages\n      if (response.status) {\n        return;\n      }\n\n      const { id, result, error } = response;\n\n      if (id && this.pendingRequests.has(id)) {\n        const { resolve, reject } = this.pendingRequests.get(id)!;\n        this.pendingRequests.delete(id);\n\n        if (error) {\n          reject(new Error(error.message || 'Python bridge error'));\n        } else {\n          resolve(result);\n        }\n      }\n    } catch (e) {\n      if (this.config.debug) {\n        console.log(`[Python Bridge] Non-JSON output: ${line}`);\n      }\n    }\n  }\n}\n","/**\n * @flowsight/desktop-test - NutJS Adapter\n *\n * Native desktop control adapter using NutJS.\n * Provides cross-platform mouse, keyboard, and screenshot capabilities.\n */\n\nimport type { NutJSConfig, NutJSAdapterInterface } from '../types.js';\n\n/**\n * Key mapping for NutJS\n */\nconst KEY_MAP: Record<string, string> = {\n  'ctrl': 'LeftControl',\n  'control': 'LeftControl',\n  'cmd': 'LeftSuper',\n  'command': 'LeftSuper',\n  'meta': 'LeftSuper',\n  'alt': 'LeftAlt',\n  'option': 'LeftAlt',\n  'shift': 'LeftShift',\n  'enter': 'Return',\n  'return': 'Return',\n  'esc': 'Escape',\n  'escape': 'Escape',\n  'backspace': 'Backspace',\n  'delete': 'Delete',\n  'tab': 'Tab',\n  'space': 'Space',\n  'up': 'Up',\n  'down': 'Down',\n  'left': 'Left',\n  'right': 'Right',\n  'home': 'Home',\n  'end': 'End',\n  'pageup': 'PageUp',\n  'pagedown': 'PageDown',\n  'insert': 'Insert',\n  'f1': 'F1', 'f2': 'F2', 'f3': 'F3', 'f4': 'F4',\n  'f5': 'F5', 'f6': 'F6', 'f7': 'F7', 'f8': 'F8',\n  'f9': 'F9', 'f10': 'F10', 'f11': 'F11', 'f12': 'F12',\n};\n\n/**\n * NutJS Adapter - native desktop control\n */\nexport class NutJSAdapter implements NutJSAdapterInterface {\n  private config: Required<NutJSConfig>;\n  private initialized: boolean = false;\n  private nut: NutJSModule | null = null;\n\n  constructor(config: NutJSConfig = {}) {\n    this.config = {\n      keyboard: config.keyboard ?? true,\n      mouse: config.mouse ?? true,\n      keyDelay: config.keyDelay ?? 50,\n      mouseSpeed: config.mouseSpeed ?? 500,\n    };\n  }\n\n  /**\n   * Initialize NutJS\n   */\n  async initialize(): Promise<void> {\n    if (this.initialized) return;\n\n    try {\n      // Dynamic import to avoid bundling issues\n      // Try @computer-use/nut-js first (newer package), fallback to @nut-tree/nut-js\n      let nutModule: NutJSModule;\n      \n      try {\n        // @ts-expect-error - Dynamic import, types not bundled\n        nutModule = await import('@computer-use/nut-js') as NutJSModule;\n      } catch {\n        try {\n          // @ts-expect-error - Dynamic import, types not bundled\n          nutModule = await import('@nut-tree/nut-js') as NutJSModule;\n        } catch {\n          throw new Error('NutJS not installed. Run: npm install @nut-tree/nut-js');\n        }\n      }\n\n      this.nut = nutModule;\n\n      // Configure\n      if (this.nut.keyboard) {\n        this.nut.keyboard.config.autoDelayMs = this.config.keyDelay;\n      }\n      if (this.nut.mouse) {\n        this.nut.mouse.config.mouseSpeed = this.config.mouseSpeed;\n      }\n\n      this.initialized = true;\n    } catch (error: unknown) {\n      // NutJS is optional - fall back gracefully\n      const message = error instanceof Error ? error.message : String(error);\n      console.warn(`[NutJS Adapter] Not available: ${message}`);\n      this.initialized = false;\n    }\n  }\n\n  /**\n   * Cleanup\n   */\n  async cleanup(): Promise<void> {\n    this.initialized = false;\n    this.nut = null;\n  }\n\n  /**\n   * Check if NutJS is available\n   */\n  isAvailable(): boolean {\n    return this.initialized && this.nut !== null;\n  }\n\n  /**\n   * Click at coordinates\n   */\n  async click(\n    x: number,\n    y: number,\n    button: 'left' | 'right' | 'middle' = 'left',\n    count: number = 1\n  ): Promise<void> {\n    if (!this.isAvailable() || !this.nut) {\n      throw new Error('NutJS not available');\n    }\n\n    const { mouse, Button, Point } = this.nut;\n\n    await mouse.setPosition(new Point(x, y));\n\n    const mouseButton = button === 'right' ? Button.RIGHT :\n                        button === 'middle' ? Button.MIDDLE : Button.LEFT;\n\n    for (let i = 0; i < count; i++) {\n      await mouse.click(mouseButton);\n      if (i < count - 1) {\n        await this.sleep(50);\n      }\n    }\n  }\n\n  /**\n   * Move mouse to coordinates\n   */\n  async moveTo(x: number, y: number): Promise<void> {\n    if (!this.isAvailable() || !this.nut) {\n      throw new Error('NutJS not available');\n    }\n\n    const { mouse, Point } = this.nut;\n    await mouse.move([new Point(x, y)]);\n  }\n\n  /**\n   * Type text\n   */\n  async type(text: string, delay?: number): Promise<void> {\n    if (!this.isAvailable() || !this.nut) {\n      throw new Error('NutJS not available');\n    }\n\n    const { keyboard } = this.nut;\n\n    if (delay) {\n      keyboard.config.autoDelayMs = delay;\n    }\n\n    await keyboard.type(text);\n\n    if (delay) {\n      keyboard.config.autoDelayMs = this.config.keyDelay;\n    }\n  }\n\n  /**\n   * Press key or key combination\n   */\n  async press(key: string): Promise<void> {\n    if (!this.isAvailable() || !this.nut) {\n      throw new Error('NutJS not available');\n    }\n\n    const { keyboard, Key } = this.nut;\n\n    // Parse key combination (e.g., \"Control+a\", \"Meta+Shift+s\")\n    const parts = key.split('+');\n    const keys: number[] = [];\n\n    for (const part of parts) {\n      const normalizedKey = this.normalizeKey(part.trim());\n      const nutKey = Key[normalizedKey as keyof typeof Key];\n      if (nutKey !== undefined) {\n        keys.push(nutKey);\n      }\n    }\n\n    if (keys.length === 0) {\n      throw new Error(`Unknown key: ${key}`);\n    }\n\n    if (keys.length === 1) {\n      await keyboard.pressKey(keys[0]);\n      await keyboard.releaseKey(keys[0]);\n    } else {\n      // Hold modifiers, press main key, release all\n      const modifiers = keys.slice(0, -1);\n      const mainKey = keys[keys.length - 1];\n\n      for (const mod of modifiers) {\n        await keyboard.pressKey(mod);\n      }\n      await keyboard.pressKey(mainKey);\n      await keyboard.releaseKey(mainKey);\n      for (const mod of modifiers.reverse()) {\n        await keyboard.releaseKey(mod);\n      }\n    }\n  }\n\n  /**\n   * Scroll\n   */\n  async scroll(direction: 'up' | 'down' | 'left' | 'right', amount: number): Promise<void> {\n    if (!this.isAvailable() || !this.nut) {\n      throw new Error('NutJS not available');\n    }\n\n    const { mouse } = this.nut;\n\n    switch (direction) {\n      case 'up':\n        await mouse.scrollUp(amount);\n        break;\n      case 'down':\n        await mouse.scrollDown(amount);\n        break;\n      case 'left':\n        await mouse.scrollLeft(amount);\n        break;\n      case 'right':\n        await mouse.scrollRight(amount);\n        break;\n    }\n  }\n\n  /**\n   * Drag from one point to another\n   */\n  async drag(fromX: number, fromY: number, toX: number, toY: number): Promise<void> {\n    if (!this.isAvailable() || !this.nut) {\n      throw new Error('NutJS not available');\n    }\n\n    const { mouse, Point } = this.nut;\n\n    await mouse.setPosition(new Point(fromX, fromY));\n    await mouse.drag([new Point(toX, toY)]);\n  }\n\n  /**\n   * Take screenshot and return base64\n   */\n  async screenshot(): Promise<string> {\n    if (!this.isAvailable() || !this.nut) {\n      throw new Error('NutJS not available');\n    }\n\n    const { screen } = this.nut;\n\n    // Import Jimp dynamically\n    const { Jimp } = await import('jimp');\n\n    const capture = await screen.capture();\n    const image = new Jimp({\n      width: capture.width,\n      height: capture.height,\n      data: Buffer.from(capture.data),\n    });\n\n    const buffer = await image.getBuffer('image/jpeg', { quality: 75 });\n    return buffer.toString('base64');\n  }\n\n  /**\n   * Get screen size\n   */\n  async getScreenSize(): Promise<{ width: number; height: number }> {\n    if (!this.isAvailable() || !this.nut) {\n      throw new Error('NutJS not available');\n    }\n\n    const { screen } = this.nut;\n    const size = await screen.size();\n    return { width: size.width, height: size.height };\n  }\n\n  // ============================================================================\n  // Private Helpers\n  // ============================================================================\n\n  private normalizeKey(key: string): string {\n    const lower = key.toLowerCase();\n    if (KEY_MAP[lower]) {\n      return KEY_MAP[lower];\n    }\n\n    // Single letter key\n    if (key.length === 1) {\n      return key.toUpperCase();\n    }\n\n    // Return as-is (capitalized)\n    return key.charAt(0).toUpperCase() + key.slice(1);\n  }\n\n  private sleep(ms: number): Promise<void> {\n    return new Promise(resolve => setTimeout(resolve, ms));\n  }\n}\n\n// ============================================================================\n// Type definitions for NutJS module\n// ============================================================================\n\ninterface NutJSModule {\n  mouse: {\n    config: { mouseSpeed: number };\n    setPosition: (point: NutPoint) => Promise<void>;\n    move: (path: NutPoint[]) => Promise<void>;\n    click: (button: number) => Promise<void>;\n    drag: (path: NutPoint[]) => Promise<void>;\n    scrollUp: (amount: number) => Promise<void>;\n    scrollDown: (amount: number) => Promise<void>;\n    scrollLeft: (amount: number) => Promise<void>;\n    scrollRight: (amount: number) => Promise<void>;\n  };\n  keyboard: {\n    config: { autoDelayMs: number };\n    type: (text: string) => Promise<void>;\n    pressKey: (key: number) => Promise<void>;\n    releaseKey: (key: number) => Promise<void>;\n  };\n  screen: {\n    capture: () => Promise<{ width: number; height: number; data: Uint8Array }>;\n    size: () => Promise<{ width: number; height: number }>;\n  };\n  Button: {\n    LEFT: number;\n    RIGHT: number;\n    MIDDLE: number;\n  };\n  Key: Record<string, number>;\n  Point: new (x: number, y: number) => NutPoint;\n}\n\ninterface NutPoint {\n  x: number;\n  y: number;\n}\n"]}